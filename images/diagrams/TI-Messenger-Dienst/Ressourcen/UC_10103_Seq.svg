<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2654px" preserveAspectRatio="none" style="width:1756px;height:2654px;background:#FFFFFF;" version="1.1" viewBox="0 0 1756 2654" width="1756px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2642.6797" style="stroke:#181818;stroke-width:0.5;" width="587.5" x="300" y="6"/><text fill="#000000" font-family="sans-serif" font-size="19" font-weight="bold" lengthAdjust="spacing" textLength="99" x="541.75" y="23.6362">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="640.75" y="25.0513"> </text><rect fill="#DCDCDC" height="1642.6484" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="244.8984"/><rect fill="#DCDCDC" height="472.1563" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="1991.9609"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="796.5" y="422.4844"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="971.5" y="490.0625"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1145.5" y="523.8516"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="318.1758"/><rect fill="#DCDCDC" height="993.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="860.1797"/><rect fill="#DCDCDC" height="228.6758" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="2201.6523"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="422.4844"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="913.7578"/><rect fill="#F0F8FF" height="2343.5547" style="stroke:#000000;stroke-width:1.5;" width="1739" x="10" y="153.5625"/><rect fill="#ADD8E6" height="1318.3203" style="stroke:#000000;stroke-width:1.5;" width="1719" x="20" y="259.8984"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="30" y="631.4297"/><rect fill="#ADD8E6" height="466.5156" style="stroke:none;stroke-width:1.0;" width="1719" x="20" y="1111.7031"/><rect fill="#FFE4E1" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="30" y="1617.2188"/><rect fill="#F0F8FF" height="576.5703" style="stroke:none;stroke-width:1.0;" width="1739" x="10" y="1920.5469"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="30" y="2053.75"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="136" x2="136" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="430" x2="430" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="801.5" x2="801.5" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="976.5" x2="976.5" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1150.5" x2="1150.5" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1357.5" x2="1357.5" y1="111.5625" y2="2539.1172"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1647" x2="1647" y1="111.5625" y2="2539.1172"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="40" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="78.5" y="106.8457">Org-Admin</text><ellipse cx="136.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M136.5,21.5 L136.5,48.5 M123.5,29.5 L149.5,29.5 M136.5,48.5 L123.5,63.5 M136.5,48.5 L149.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="40" y="2556.6816">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="78.5" y="2579.9629">Org-Admin</text><ellipse cx="136.5" cy="2593.1797" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M136.5,2601.1797 L136.5,2628.1797 M123.5,2609.1797 L149.5,2609.1797 M136.5,2628.1797 L123.5,2643.1797 M136.5,2628.1797 L149.5,2643.1797 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="304" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="361.5" y="75.5645">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="311" y="98.8457">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="304" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="361.5" y="2563.6816">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="311" y="2586.9629">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="719.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="732.5" y="98.8457">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="719.5" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="732.5" y="2563.6816">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="894.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="925" y="98.8457">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="894.5" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="925" y="2563.6816">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1068.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1096" y="98.8457">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1068.5" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1096" y="2563.6816">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1242.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1249.5" y="98.8457">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1242.5" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1249.5" y="2563.6816">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1565" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1599" y="75.5645">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1595" y="98.8457">IDP-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1565" y="2538.1172"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1599" y="2563.6816">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1595" y="2586.9629">IDP-Dienst</text><rect fill="#DCDCDC" height="1642.6484" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="244.8984"/><rect fill="#DCDCDC" height="472.1563" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="1991.9609"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="796.5" y="422.4844"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="971.5" y="490.0625"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1145.5" y="523.8516"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="318.1758"/><rect fill="#DCDCDC" height="993.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="860.1797"/><rect fill="#DCDCDC" height="228.6758" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="2201.6523"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="422.4844"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="913.7578"/><path d="M10,153.5625 L74,153.5625 L74,160.6953 L64,170.6953 L10,170.6953 L10,153.5625 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2343.5547" style="stroke:#000000;stroke-width:1.5;" width="1739" x="10" y="153.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="166.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="171.5933">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="515" x="94" y="170.4141">Organisation nicht am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="609" y="171.5933">]</text><polygon fill="#000000" points="413.5,240.8984,423.5,244.8984,413.5,248.8984,417.5,244.8984" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="419.5" y1="244.8984" y2="244.8984"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="206" x="143.5" y="219.1001">Organisation verifizieren</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="193" x="143.5" y="238.8892">(Verfahren auswählen)</text><path d="M20,259.8984 L84,259.8984 L84,267.0313 L74,277.0313 L20,277.0313 L20,259.8984 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1318.3203" style="stroke:#000000;stroke-width:1.5;" width="1719" x="20" y="259.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="272.9653">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="277.9292">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="146" x="104" y="276.75">OpenID Connect</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="250" y="277.9292">]</text><polygon fill="#000000" points="1341,314.1758,1351,318.1758,1341,322.1758,1345,318.1758" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="318.1758" y2="318.1758"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="442.5" y="312.1665">POST I_Registration</text><path d="M1368,285.6563 L1368,332.6563 L1616,332.6563 L1616,295.6563 L1606,285.6563 L1368,285.6563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1606,285.6563 L1606,295.6563 L1616,295.6563 L1606,285.6563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1374" y="305.5078">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1374" y="324.1328">durch die gematik spezifiziert</text><polygon fill="#000000" points="446.5,359.6953,436.5,363.6953,446.5,367.6953,442.5,363.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="363.6953" y2="363.6953"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="323" x="1028" y="357.686">Redirect to IDP Authorization Endpoint</text><polygon fill="#000000" points="1630,418.4844,1640,422.4844,1630,426.4844,1634,422.4844" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1636" y1="422.4844" y2="422.4844"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="442.5" y="416.4751">GET /authorize</text><polygon fill="#000000" points="817.5,452.2734,807.5,456.2734,817.5,460.2734,813.5,456.2734" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="811.5" x2="1641" y1="456.2734" y2="456.2734"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="1426" y="450.2642">Authentication challenge</text><polygon fill="#000000" points="959.5,486.0625,969.5,490.0625,959.5,494.0625,963.5,490.0625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="806.5" x2="965.5" y1="490.0625" y2="490.0625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="813.5" y="484.0532">SignDocument</text><polygon fill="#000000" points="1133.5,519.8516,1143.5,523.8516,1133.5,527.8516,1137.5,523.8516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="981.5" x2="1139.5" y1="523.8516" y2="523.8516"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="139" x="988.5" y="517.8423">SICCT command</text><polygon fill="#000000" points="992.5,533.8516,982.5,537.8516,992.5,541.8516,988.5,537.8516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="986.5" x2="1149.5" y1="537.8516" y2="537.8516"/><polygon fill="#000000" points="817.5,587.4297,807.5,591.4297,817.5,595.4297,813.5,591.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="811.5" x2="975.5" y1="591.4297" y2="591.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="79" x="828.5" y="565.6313">Response</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="141" x="828.5" y="585.4204">signedDocument</text><path d="M30,631.4297 L100,631.4297 L100,638.5625 L90,648.5625 L30,648.5625 L30,631.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="30" y="631.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="644.4966">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="648.2964">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="647.353">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="648.2964">]</text><polygon fill="#000000" points="147.5,672.8125,137.5,676.8125,147.5,680.8125,143.5,676.8125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="795.5" y1="676.8125" y2="676.8125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="222" x="567.5" y="670.8032">SMC-B nicht freigeschaltet</text><polygon fill="#000000" points="1630,763.6016,1640,767.6016,1630,771.6016,1634,767.6016" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1636" y1="767.6016" y2="767.6016"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="808.5" y="761.5923">Authentication response</text><polygon fill="#000000" points="446.5,797.3906,436.5,801.3906,446.5,805.3906,442.5,801.3906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1646" y1="801.3906" y2="801.3906"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="1484" y="795.3813">Authorization code</text><polygon fill="#000000" points="1341,856.1797,1351,860.1797,1341,864.1797,1345,860.1797" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="860.1797" y2="860.1797"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="294" x="442.5" y="854.1704">POST /register (Authorization code)</text><polygon fill="#000000" points="1630,909.7578,1640,913.7578,1630,917.7578,1634,913.7578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1636" y1="913.7578" y2="913.7578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="178" x="1370" y="887.9595">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="177" x="1370" y="907.7485">{authorization code}</text><polygon fill="#000000" points="1374,943.5469,1364,947.5469,1374,951.5469,1370,947.5469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1368" x2="1646" y1="947.5469" y2="947.5469"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="72" x="1568" y="941.5376">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1065.7031" y2="1065.7031"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1065.7031" y2="1078.7031"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1078.7031" y2="1078.7031"/><polygon fill="#000000" points="1374,1074.7031,1364,1078.7031,1374,1082.7031,1370,1078.7031" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="92" x="1370" y="1000.3267">enthaltene</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="149" x="1370" y="1020.1157">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="170" x="1370" y="1039.9048">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="1370" y="1059.6938">prüfen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1739" y1="1112.7031" y2="1112.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="1128.7339">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="141" x="30" y="1127.5547">KIM - Verfahren</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="171" y="1128.7339">]</text><polygon fill="#000000" points="1341,1179.1172,1351,1183.1172,1341,1187.1172,1345,1183.1172" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="1347" y1="1183.1172" y2="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="522" x="143.5" y="1177.1079">KIM-Adresse in Eingabemaske eintragen (POST I_Registration)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1236.6953" y2="1236.6953"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1236.6953" y2="1249.6953"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1249.6953" y2="1249.6953"/><polygon fill="#000000" points="1374,1245.6953,1364,1249.6953,1374,1253.6953,1370,1249.6953" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="228" x="1370" y="1210.897">Abfrage des LDAP-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="208" x="1370" y="1230.686">Eintrags zur KIM-Adresse</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1328.2734" y2="1328.2734"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1328.2734" y2="1341.2734"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1341.2734" y2="1341.2734"/><polygon fill="#000000" points="1374,1337.2734,1364,1341.2734,1374,1345.2734,1370,1341.2734" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="238" x="1370" y="1302.4751">Speicherung der telematikId</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="1370" y="1322.2642">und der professionOID</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1439.6406" y2="1439.6406"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1439.6406" y2="1452.6406"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1452.6406" y2="1452.6406"/><polygon fill="#000000" points="1374,1448.6406,1364,1452.6406,1374,1456.6406,1370,1452.6406" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="149" x="1370" y="1394.0532">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="170" x="1370" y="1413.8423">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="1370" y="1433.6313">prüfen</text><polygon fill="#000000" points="147.5,1507.4297,137.5,1511.4297,147.5,1515.4297,143.5,1511.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="1352" y1="1511.4297" y2="1511.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="191" x="1155" y="1505.4204">KIM Nachricht mit URL</text><polygon fill="#000000" points="1341,1541.2188,1351,1545.2188,1341,1549.2188,1345,1545.2188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="1347" y1="1545.2188" y2="1545.2188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="238" x="143.5" y="1539.2095">URL in KIM-Nachricht öffnen</text><path d="M30,1617.2188 L100,1617.2188 L100,1624.3516 L90,1634.3516 L30,1634.3516 L30,1617.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="30" y="1617.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="1630.2856">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="1634.0854">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="1633.1421">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="1634.0854">]</text><polygon fill="#000000" points="446.5,1658.6016,436.5,1662.6016,446.5,1666.6016,442.5,1662.6016" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="440.5" x2="1352" y1="1662.6016" y2="1662.6016"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="1031" y="1656.5923">keine gültige ProfessionOID gefunden</text><polygon fill="#000000" points="147.5,1692.3906,137.5,1696.3906,147.5,1700.3906,143.5,1696.3906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="424.5" y1="1696.3906" y2="1696.3906"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="153.5" y="1690.3813">Authentisierung fehlgeschlagen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1806.9688" y2="1806.9688"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1806.9688" y2="1819.9688"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1819.9688" y2="1819.9688"/><polygon fill="#000000" points="1374,1815.9688,1364,1819.9688,1374,1823.9688,1370,1819.9688" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="107" x="1370" y="1781.1704">Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="134" x="1370" y="1800.9595">authentifizieren</text><polygon fill="#000000" points="446.5,1849.7578,436.5,1853.7578,446.5,1857.7578,442.5,1853.7578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="1853.7578" y2="1853.7578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1300" y="1847.7485">status</text><polygon fill="#000000" points="147.5,1883.5469,137.5,1887.5469,147.5,1891.5469,143.5,1887.5469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141.5" x2="429.5" y1="1887.5469" y2="1887.5469"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="200" x="223.5" y="1881.5376">Verifizierung erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1749" y1="1921.5469" y2="1921.5469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="1937.5776">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="465" x="20" y="1936.3984">Organisation am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="485" y="1937.5776">]</text><polygon fill="#000000" points="413.5,1987.9609,423.5,1991.9609,413.5,1995.9609,417.5,1991.9609" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="419.5" y1="1991.9609" y2="1991.9609"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="197" x="143.5" y="1985.9517">Admin Account anlegen</text><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="477.5" y1="2025.75" y2="2025.75"/><line style="stroke:#000000;stroke-width:1.0;" x1="477.5" x2="477.5" y1="2025.75" y2="2038.75"/><line style="stroke:#000000;stroke-width:1.0;" x1="436.5" x2="477.5" y1="2038.75" y2="2038.75"/><polygon fill="#000000" points="446.5,2034.75,436.5,2038.75,446.5,2042.75,442.5,2038.75" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="347" x="442.5" y="2019.7407">Prüfung auf existierenden Admin Account</text><path d="M30,2053.75 L100,2053.75 L100,2060.8828 L90,2070.8828 L30,2070.8828 L30,2053.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="30" y="2053.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="2066.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="2070.6167">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="2069.6733">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="2070.6167">]</text><polygon fill="#000000" points="147.5,2095.1328,137.5,2099.1328,147.5,2103.1328,143.5,2099.1328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="424.5" y1="2099.1328" y2="2099.1328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="261" x="157.5" y="2093.1235">Admin Account existiert bereits</text><polygon fill="#000000" points="1341,2197.6523,1351,2201.6523,1341,2205.6523,1345,2201.6523" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="2201.6523" y2="2201.6523"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="418" x="442.5" y="2195.6431">POST I_Registration (id_token, Client-Credentials)</text><path d="M1368,2169.1328 L1368,2216.1328 L1616,2216.1328 L1616,2179.1328 L1606,2169.1328 L1368,2169.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1606,2169.1328 L1606,2179.1328 L1616,2179.1328 L1606,2169.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1374" y="2188.9844">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1374" y="2207.6094">durch die gematik spezifiziert</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="2272.1719" y2="2272.1719"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="2272.1719" y2="2285.1719"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="2285.1719" y2="2285.1719"/><polygon fill="#000000" points="1374,2281.1719,1364,2285.1719,1374,2289.1719,1370,2285.1719" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="1370" y="2266.1626">Client-Credentials-Policy prüfen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="2383.5391" y2="2383.5391"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="2383.5391" y2="2396.5391"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="2396.5391" y2="2396.5391"/><polygon fill="#000000" points="1374,2392.5391,1364,2396.5391,1374,2400.5391,1370,2396.5391" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="161" x="1370" y="2337.9517">Org-Admin Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="1370" y="2357.7407">für die Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="67" x="1370" y="2377.5298">anlegen</text><polygon fill="#000000" points="446.5,2426.3281,436.5,2430.3281,446.5,2434.3281,442.5,2430.3281" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="2430.3281" y2="2430.3281"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1300" y="2424.3188">status</text><polygon fill="#000000" points="147.5,2460.1172,137.5,2464.1172,147.5,2468.1172,143.5,2464.1172" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141.5" x2="429.5" y1="2464.1172" y2="2464.1172"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="279.5" y="2458.1079">Account angelegt</text><!--MD5=[cfa41c8de8406ea47aafae64f683065c]
@startuml "Authentisieren einer Organisation am TI-Messenger-Dienst"
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}

  actor oa as "Akteur in der Rolle\nOrg-Admin"
    box <size:19>Endgerät</size> #WhiteSmoke
    participant wb as "Frontend des \nRegistrierungs-Dienstes"
    participant au as "Authenticator"
    end box
  participant ko as "Konnektor"
  participant kt as "eHealth KT"
  participant rd as "Registrierungs-Dienst"
  participant ip as "zentraler \nIDP-Dienst"

|||
alt#LightGrey #AliceBlue <size:16>Organisation nicht am Registrierungs-Dienst authentisiert</size>
|||
      oa -> wb: Organisation verifizieren \n(Verfahren auswählen)
      alt#LightGrey #LightBlue <size:16>OpenID Connect</size>
          activate wb
        wb -> rd:POST I_Registration
        note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
          activate rd
        rd - -> wb: Redirect to IDP Authorization Endpoint
          deactivate rd
        |||
        wb -> ip: GET /authorize
          activate au
          activate ip
        ip -> au: Authentication challenge
        au -> ko: SignDocument
          activate ko
        ko -> kt: SICCT command
          activate kt
        kt - -> ko
          deactivate kt
        ko - -> au: Response \nsignedDocument
        |||
          deactivate ko

      opt #MistyRose <size:15>Abbruch</size>
        au -> oa: SMC-B nicht freigeschaltet
        |||
      end
        |||
        au - ->ip: Authentication response
          deactivate au
        ip - -> wb: Authorization code
          deactivate ip
        |||
        wb -> rd: POST /register (Authorization code)
          activate rd
        rd -> ip: POST /tokenEndpoint\n{authorization code}
          activate ip
        ip - -> rd: id_token
          deactivate ip
        |||
        rd -> rd: enthaltene \nProfessionOID auf \ngültige Organisation \nprüfen
        |||
      else <size:16>KIM - Verfahren</size>
        |||
        oa -> rd: KIM-Adresse in Eingabemaske eintragen (POST I_Registration)
        rd -> rd: Abfrage des LDAP-Directory\nEintrags zur KIM-Adresse
        |||
        rd -> rd: Speicherung der telematikId\nund der professionOID
        |||
        rd -> rd: ProfessionOID auf\ngültige Organisation\nprüfen
        |||
        rd -> oa: KIM Nachricht mit URL
        oa -> rd: URL in KIM-Nachricht öffnen
        |||
      end
      |||

    opt #MistyRose <size:15>Abbruch</size>
      rd -> wb: keine gültige ProfessionOID gefunden
      wb -> oa: Authentisierung fehlgeschlagen
      |||
    end

      |||
      rd-> rd: Organisation \nauthentifizieren
      rd - -> wb: status
        deactivate rd
      wb - -> oa: Verifizierung erfolgreich
        deactivate wb
      |||

      else <size:16>Organisation am Registrierungs-Dienst authentisiert</size>
        |||
        oa -> wb: Admin Account anlegen
          activate wb
        wb -> wb: Prüfung auf existierenden Admin Account
         opt #MistyRose <size:15>Abbruch</size>
         wb -> oa: Admin Account existiert bereits
         |||
        end
         |||
        wb -> rd: POST I_Registration (id_token, Client-Credentials)
        note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
          activate rd
        |||
        rd -> rd: Client-Credentials-Policy prüfen
        |||
        rd -> rd: Org-Admin Account\nfür die Organisation \nanlegen
        rd - -> wb: status
          deactivate rd
        wb - -> oa: Account angelegt
          deactivate wb
        |||
end
|||
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>