<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2709px" preserveAspectRatio="none" style="width:1522px;height:2709px;background:#FFFFFF;" version="1.1" viewBox="0 0 1522 2709" width="1522px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2697.7031" style="stroke:#181818;stroke-width:0.5;" width="405" x="286.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="19" font-weight="bold" lengthAdjust="spacing" textLength="85" x="444.5" y="25.7236">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="529.5" y="27.042"> </text><rect fill="#DCDCDC" height="2260.8359" style="stroke:#000000;stroke-width:1.0;" width="10" x="397" y="254.5547"/><rect fill="#DCDCDC" height="252.75" style="stroke:#000000;stroke-width:1.0;" width="10" x="600.5" y="476.4297"/><rect fill="#DCDCDC" height="35.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="867.5" y="511.8125"/><rect fill="#DCDCDC" height="47.8164" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="332.8477"/><rect fill="#DCDCDC" height="1252.75" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="824.9453"/><rect fill="#DCDCDC" height="237.3477" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="2242.6602"/><rect fill="#DCDCDC" height="323.5156" style="stroke:#000000;stroke-width:1.0;" width="10" x="1409.5" y="441.0469"/><rect fill="#DCDCDC" height="35.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="1409.5" y="881.7109"/><rect fill="#F0F8FF" height="2391.0781" style="stroke:#000000;stroke-width:1.5;" width="1506.5" x="10" y="157.3125"/><rect fill="#ADD8E6" height="1302.0234" style="stroke:#000000;stroke-width:1.5;" width="1486.5" x="20" y="269.5547"/><rect fill="#FFE4E1" height="82.6016" style="stroke:#000000;stroke-width:1.5;" width="667.5" x="30" y="587.1953"/><rect fill="#ADD8E6" height="483.9531" style="stroke:none;stroke-width:1.0;" width="1486.5" x="20" y="1087.625"/><rect fill="#FFE4E1" height="117.9844" style="stroke:#000000;stroke-width:1.5;" width="1146.5" x="30" y="1610.5781"/><rect fill="#FFE4E1" height="82.6016" style="stroke:#000000;stroke-width:1.5;" width="1146.5" x="30" y="1935.7109"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="124" x2="124" y1="115.3125" y2="2590.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="401.5" x2="401.5" y1="115.3125" y2="2590.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="605.5" x2="605.5" y1="115.3125" y2="2590.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="872.5" x2="872.5" y1="115.3125" y2="2590.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1065.5" x2="1065.5" y1="115.3125" y2="2590.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1414.5" x2="1414.5" y1="115.3125" y2="2590.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="162" x="40" y="85.7617">Akteur in der Rolle</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="95" x="73.5" y="110.918">Org-Admin</text><ellipse cx="124" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M124,21.5 L124,48.5 M111,29.5 L137,29.5 M124,48.5 L111,63.5 M124,48.5 L137,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="162" x="40" y="2610.1523">Akteur in der Rolle</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="95" x="73.5" y="2635.3086">Org-Admin</text><ellipse cx="124" cy="2648.2031" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M124,2656.2031 L124,2683.2031 M111,2664.2031 L137,2664.2031 M124,2683.2031 L111,2698.2031 M124,2683.2031 L137,2698.2031 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="64.3125" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="223" x="290.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="116" x="341" y="77.7617">Frontend des</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="209" x="297.5" y="102.918">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="64.3125" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="223" x="290.5" y="2589.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="116" x="341" y="2617.1523">Frontend des</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="209" x="297.5" y="2642.3086">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="523.5" y="75.1563"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="115" x="548" y="102.918">Authenticator</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="523.5" y="2589.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="115" x="548" y="2617.1523">Authenticator</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="790.5" y="75.1563"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="89" x="828" y="102.918">Konnektor</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="790.5" y="2589.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="89" x="828" y="2617.1523">Konnektor</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="202" x="964.5" y="75.1563"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="188" x="971.5" y="102.918">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="202" x="964.5" y="2589.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="188" x="971.5" y="2617.1523">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="64.3125" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1332.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="76" x="1373.5" y="77.7617">zentraler</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="95" x="1367" y="102.918">IDP-Dienst</text><rect fill="#EFEFFF" height="64.3125" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1332.5" y="2589.3906"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="76" x="1373.5" y="2617.1523">zentraler</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="95" x="1367" y="2642.3086">IDP-Dienst</text><rect fill="#DCDCDC" height="2260.8359" style="stroke:#000000;stroke-width:1.0;" width="10" x="397" y="254.5547"/><rect fill="#DCDCDC" height="252.75" style="stroke:#000000;stroke-width:1.0;" width="10" x="600.5" y="476.4297"/><rect fill="#DCDCDC" height="35.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="867.5" y="511.8125"/><rect fill="#DCDCDC" height="47.8164" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="332.8477"/><rect fill="#DCDCDC" height="1252.75" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="824.9453"/><rect fill="#DCDCDC" height="237.3477" style="stroke:#000000;stroke-width:1.0;" width="10" x="1060.5" y="2242.6602"/><rect fill="#DCDCDC" height="323.5156" style="stroke:#000000;stroke-width:1.0;" width="10" x="1409.5" y="441.0469"/><rect fill="#DCDCDC" height="35.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="1409.5" y="881.7109"/><path d="M10,157.3125 L71,157.3125 L71,165.6641 L61,175.6641 L10,175.6641 L10,157.3125 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2391.0781" style="stroke:#000000;stroke-width:1.5;" width="1506.5" x="10" y="157.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="171.8076">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="86" y="177.0205">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="437" x="90" y="175.9219">Organisation nicht am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="527" y="177.0205">]</text><polygon fill="#000000" points="385,250.5547,395,254.5547,385,258.5547,389,254.5547" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="124" x2="391" y1="254.5547" y2="254.5547"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="131" y="238.1279">1</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="177" x="144" y="227.4365">Organisation verifizieren</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="144" y="248.8193">(Verfahren auswählen)</text><path d="M20,269.5547 L81,269.5547 L81,277.9063 L71,287.9063 L20,287.9063 L20,269.5547 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1302.0234" style="stroke:#000000;stroke-width:1.5;" width="1486.5" x="20" y="269.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="35" y="284.0498">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="96" y="289.2627">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="126" x="100" y="288.1641">OpenID Connect</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="226" y="289.2627">]</text><polygon fill="#000000" points="1048.5,328.8477,1058.5,332.8477,1048.5,336.8477,1052.5,332.8477" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="407" x2="1054.5" y1="332.8477" y2="332.8477"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="414" y="327.1123">2</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="148" x="427" y="327.1123">POST I_Registration</text><path d="M1075,298.0313 L1075,348.0313 L1298,348.0313 L1298,308.0313 L1288,298.0313 L1075,298.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1288,298.0313 L1288,308.0313 L1298,308.0313 L1288,298.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="152" x="1081" y="319.6406">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="202" x="1081" y="339.7656">durch die gematik spezifiziert</text><polygon fill="#000000" points="418,376.6641,408,380.6641,418,384.6641,414,380.6641" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412" x2="1064.5" y1="380.6641" y2="380.6641"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="764.5" y="374.9287">3</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="281" x="777.5" y="374.9287">Redirect to IDP Authorization Endpoint</text><polygon fill="#000000" points="1397.5,437.0469,1407.5,441.0469,1397.5,445.0469,1401.5,441.0469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="407" x2="1403.5" y1="441.0469" y2="441.0469"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="414" y="435.3115">4</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="109" x="427" y="435.3115">GET /authorize</text><polygon fill="#000000" points="621.5,472.4297,611.5,476.4297,621.5,480.4297,617.5,476.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="615.5" x2="1408.5" y1="476.4297" y2="476.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1212.5" y="470.6943">5</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="177" x="1225.5" y="470.6943">Authentication challenge</text><polygon fill="#000000" points="855.5,507.8125,865.5,511.8125,855.5,515.8125,859.5,511.8125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="610.5" x2="861.5" y1="511.8125" y2="511.8125"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="617.5" y="506.0771">6</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="148" x="630.5" y="506.0771">ExternalAuthenticate</text><polygon fill="#000000" points="621.5,543.1953,611.5,547.1953,621.5,551.1953,617.5,547.1953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="615.5" x2="871.5" y1="547.1953" y2="547.1953"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="632.5" y="541.46">7</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="220" x="645.5" y="541.46">ExternalAuthenticateResponse</text><path d="M30,587.1953 L95,587.1953 L95,595.5469 L85,605.5469 L30,605.5469 L30,587.1953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="82.6016" style="stroke:#000000;stroke-width:1.5;" width="667.5" x="30" y="587.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="45" y="601.6904">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="110" y="605.6455">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="59" x="114" y="604.7666">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="173" y="605.6455">]</text><polygon fill="#000000" points="135,632.7969,125,636.7969,135,640.7969,131,636.7969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="129" x2="599.5" y1="636.7969" y2="636.7969"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="385.5" y="631.0615">8</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="195" x="398.5" y="631.0615">SMC-B nicht freigeschaltet</text><polygon fill="#000000" points="1397.5,725.1797,1407.5,729.1797,1397.5,733.1797,1401.5,729.1797" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="605.5" x2="1403.5" y1="729.1797" y2="729.1797"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="612.5" y="723.4443">9</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="175" x="625.5" y="723.4443">Authentication response</text><polygon fill="#000000" points="418,760.5625,408,764.5625,418,768.5625,414,764.5625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412" x2="1413.5" y1="764.5625" y2="764.5625"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1249.5" y="758.8271">10</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="1271.5" y="758.8271">Authorization code</text><polygon fill="#000000" points="1048.5,820.9453,1058.5,824.9453,1048.5,828.9453,1052.5,824.9453" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="407" x2="1054.5" y1="824.9453" y2="824.9453"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="414" y="819.21">11</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="261" x="436" y="819.21">POST /register (Authorization code)</text><polygon fill="#000000" points="1397.5,877.7109,1407.5,881.7109,1397.5,885.7109,1401.5,881.7109" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1403.5" y1="881.7109" y2="881.7109"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="865.2842">12</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="1099.5" y="854.5928">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="146" x="1099.5" y="875.9756">{authorization code}</text><polygon fill="#000000" points="1081.5,913.0938,1071.5,917.0938,1081.5,921.0938,1077.5,917.0938" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1075.5" x2="1413.5" y1="917.0938" y2="917.0938"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1324.5" y="911.3584">13</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="61" x="1346.5" y="911.3584">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1041.625" y2="1041.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1041.625" y2="1054.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1054.625" y2="1054.625"/><polygon fill="#000000" points="1081.5,1050.625,1071.5,1054.625,1081.5,1058.625,1077.5,1054.625" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1003.8154">14</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="74" x="1099.5" y="971.7412">enthaltene</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="135" x="1099.5" y="993.124">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="1099.5" y="1014.5068">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="1099.5" y="1035.8896">prüfen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1506.5" y1="1088.625" y2="1088.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="25" y="1106.333">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="117" x="29" y="1105.2344">KIM - Verfahren</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="146" y="1106.333">]</text><polygon fill="#000000" points="1048.5,1158.1328,1058.5,1162.1328,1048.5,1166.1328,1052.5,1162.1328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="124" x2="1054.5" y1="1162.1328" y2="1162.1328"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="131" y="1156.3975">15</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="463" x="153" y="1156.3975">KIM-Adresse in Eingabemaske eintragen (POST I_Registration)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1218.8984" y2="1218.8984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1218.8984" y2="1231.8984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1231.8984" y2="1231.8984"/><polygon fill="#000000" points="1081.5,1227.8984,1071.5,1231.8984,1081.5,1235.8984,1077.5,1231.8984" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1202.4717">16</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="211" x="1099.5" y="1191.7803">Abfrage des LDAP-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="188" x="1099.5" y="1213.1631">Eintrags zur KIM-Adresse</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1313.6641" y2="1313.6641"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1313.6641" y2="1326.6641"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1326.6641" y2="1326.6641"/><polygon fill="#000000" points="1081.5,1322.6641,1071.5,1326.6641,1081.5,1330.6641,1077.5,1326.6641" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1297.2373">17</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="204" x="1099.5" y="1286.5459">Speicherung der telematikId</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="1099.5" y="1307.9287">und der professionOID</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1429.8125" y2="1429.8125"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1429.8125" y2="1442.8125"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1442.8125" y2="1442.8125"/><polygon fill="#000000" points="1081.5,1438.8125,1071.5,1442.8125,1081.5,1446.8125,1077.5,1442.8125" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1402.6943">18</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="135" x="1099.5" y="1381.3115">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="1099.5" y="1402.6943">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="1099.5" y="1424.0771">prüfen</text><polygon fill="#000000" points="135,1499.1953,125,1503.1953,135,1507.1953,131,1503.1953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="129" x2="1059.5" y1="1503.1953" y2="1503.1953"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="865.5" y="1497.46">19</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="887.5" y="1497.46">KIM Nachricht mit URL</text><polygon fill="#000000" points="1048.5,1534.5781,1058.5,1538.5781,1048.5,1542.5781,1052.5,1538.5781" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="124" x2="1054.5" y1="1538.5781" y2="1538.5781"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="131" y="1532.8428">20</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="210" x="153" y="1532.8428">URL in KIM-Nachricht öffnen</text><path d="M30,1610.5781 L95,1610.5781 L95,1618.9297 L85,1628.9297 L30,1628.9297 L30,1610.5781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="117.9844" style="stroke:#000000;stroke-width:1.5;" width="1146.5" x="30" y="1610.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="45" y="1625.0732">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="110" y="1629.0283">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="59" x="114" y="1628.1494">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="173" y="1629.0283">]</text><polygon fill="#000000" points="418,1656.1797,408,1660.1797,418,1664.1797,414,1660.1797" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="412" x2="1059.5" y1="1660.1797" y2="1660.1797"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="755.5" y="1654.4443">21</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="276" x="777.5" y="1654.4443">keine gültige ProfessionOID gefunden</text><polygon fill="#000000" points="135,1691.5625,125,1695.5625,135,1699.5625,131,1695.5625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="129" x2="396" y1="1695.5625" y2="1695.5625"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="141" y="1689.8271">22</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="227" x="163" y="1689.8271">Authentisierung fehlgeschlagen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1809.3281" y2="1809.3281"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1809.3281" y2="1822.3281"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1822.3281" y2="1822.3281"/><polygon fill="#000000" points="1081.5,1818.3281,1071.5,1822.3281,1081.5,1826.3281,1077.5,1822.3281" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1792.9014">23</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="92" x="1099.5" y="1782.21">Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="111" x="1099.5" y="1803.5928">authentifizieren</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="1882.7109" y2="1882.7109"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="1882.7109" y2="1895.7109"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="1895.7109" y2="1895.7109"/><polygon fill="#000000" points="1081.5,1891.7109,1071.5,1895.7109,1081.5,1899.7109,1077.5,1895.7109" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="1876.9756">24</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="303" x="1099.5" y="1876.9756">Prüfung auf existierenden Admin Account</text><path d="M30,1935.7109 L95,1935.7109 L95,1944.0625 L85,1954.0625 L30,1954.0625 L30,1935.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="82.6016" style="stroke:#000000;stroke-width:1.5;" width="1146.5" x="30" y="1935.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="45" y="1950.2061">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="110" y="1954.1611">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="59" x="114" y="1953.2822">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="173" y="1954.1611">]</text><polygon fill="#000000" points="135,1981.3125,125,1985.3125,135,1989.3125,131,1985.3125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="129" x2="1059.5" y1="1985.3125" y2="1985.3125"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="493.5" y="1979.5771">25</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="538" x="515.5" y="1979.5771">Organisation bereits authentifiziert und ein Admin-Account existiert bereits</text><polygon fill="#000000" points="418,2073.6953,408,2077.6953,418,2081.6953,414,2077.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412" x2="1064.5" y1="2077.6953" y2="2077.6953"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="994.5" y="2071.96">26</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="42" x="1016.5" y="2071.96">status</text><polygon fill="#000000" points="135,2109.0781,125,2113.0781,135,2117.0781,131,2113.0781" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="129" x2="396" y1="2113.0781" y2="2113.0781"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="192" y="2107.3428">27</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="176" x="214" y="2107.3428">Verifizierung erfolgreich</text><polygon fill="#000000" points="385,2190.8438,395,2194.8438,385,2198.8438,389,2194.8438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="124" x2="391" y1="2194.8438" y2="2194.8438"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="131" y="2178.417">28</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="173" x="153" y="2167.7256">Admin Account anlegen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="163" x="153" y="2189.1084">(Passwort + 2. Faktor)</text><polygon fill="#000000" points="1048.5,2238.6602,1058.5,2242.6602,1048.5,2246.6602,1052.5,2242.6602" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="407" x2="1054.5" y1="2242.6602" y2="2242.6602"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="414" y="2236.9248">29</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="449" x="436" y="2236.9248">POST I_Registration (Admin-Account Credentials + 2. Faktor)</text><path d="M1075,2207.8438 L1075,2257.8438 L1298,2257.8438 L1298,2217.8438 L1288,2207.8438 L1075,2207.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1288,2207.8438 L1288,2217.8438 L1298,2217.8438 L1288,2207.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="152" x="1081" y="2229.4531">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="202" x="1081" y="2249.5781">durch die gematik spezifiziert</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="2315.4766" y2="2315.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="2315.4766" y2="2328.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="2328.4766" y2="2328.4766"/><polygon fill="#000000" points="1081.5,2324.4766,1071.5,2328.4766,1081.5,2332.4766,1077.5,2328.4766" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="2309.7412">30</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="185" x="1099.5" y="2309.7412">Credentials-Policy prüfen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1070.5" x2="1112.5" y1="2431.625" y2="2431.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1112.5" x2="1112.5" y1="2431.625" y2="2444.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1071.5" x2="1112.5" y1="2444.625" y2="2444.625"/><polygon fill="#000000" points="1081.5,2440.625,1071.5,2444.625,1081.5,2448.625,1077.5,2444.625" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1077.5" y="2404.5068">31</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="1099.5" y="2383.124">Org-Admin Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="1099.5" y="2404.5068">für die Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="57" x="1099.5" y="2425.8896">anlegen</text><polygon fill="#000000" points="418,2476.0078,408,2480.0078,418,2484.0078,414,2480.0078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412" x2="1064.5" y1="2480.0078" y2="2480.0078"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="994.5" y="2474.2725">32</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="42" x="1016.5" y="2474.2725">status</text><polygon fill="#000000" points="135,2511.3906,125,2515.3906,135,2519.3906,131,2515.3906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="129" x2="401" y1="2515.3906" y2="2515.3906"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="247" y="2509.6553">33</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="126" x="269" y="2509.6553">Account angelegt</text><!--MD5=[fe40203f4766978e70964311f19a3580]
@startuml "Authentisieren einer Organisation am TI-Messenger-Dienst"
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
scale max 2048 width
autonumber

skinparam sequence {
  ArrowColor black
  ArrowFontSize 17
  ActorBorderColor black
  LifeLineBorderColor black
  LifeLineBackgroundColor Gainsboro

  ParticipantBorderColor Motivation
  ParticipantBackgroundColor Motivation
  ParticipantFontSize 20
  ParticipantFontColor black
  ParticipantBorderColor Black
  ParticipantBackgroundColor MOTIVATION

  ActorBackgroundColor Gainsboro
  ActorFontColor black
  ActorFontSize 20
}

actor oa as "Akteur in der Rolle\nOrg-Admin"
  box <size:19>Endgerät</size> #WhiteSmoke
  participant wb as "Frontend des \nRegistrierungs-Dienstes"
  participant au as "Authenticator"
  end box
participant ko as "Konnektor"
participant rd as "Registrierungs-Dienst"
participant ip as "zentraler \nIDP-Dienst"



|||
alt#LightGrey #AliceBlue <size:16>Organisation nicht am Registrierungs-Dienst authentisiert</size>
|||
      oa -> wb: Organisation verifizieren \n(Verfahren auswählen)
      alt#LightGrey #LightBlue <size:16>OpenID Connect</size>
          activate wb
        wb -> rd:POST I_Registration
        note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
          activate rd
        rd - -> wb: Redirect to IDP Authorization Endpoint
          deactivate rd
        |||
        wb -> ip: GET /authorize
        activate ip
        ip -> au: Authentication challenge
        activate au
        au -> ko: ExternalAuthenticate
          activate ko
        ko - -> au: ExternalAuthenticateResponse
        |||
          deactivate ko

      opt #MistyRose <size:15>Abbruch</size>
        au -> oa: SMC-B nicht freigeschaltet
        |||
      end
        |||
        au - ->ip: Authentication response
          deactivate au
        ip - -> wb: Authorization code
          deactivate ip
        |||
        wb -> rd: POST /register (Authorization code)
          activate rd
        rd -> ip: POST /tokenEndpoint\n{authorization code}
          activate ip
        ip - -> rd: id_token
          deactivate ip
        |||
        rd -> rd: enthaltene \nProfessionOID auf \ngültige Organisation \nprüfen
        |||
      else <size:16>KIM - Verfahren</size>
        |||
        oa -> rd: KIM-Adresse in Eingabemaske eintragen (POST I_Registration)
        rd -> rd: Abfrage des LDAP-Directory\nEintrags zur KIM-Adresse
        |||
        rd -> rd: Speicherung der telematikId\nund der professionOID
        |||
        rd -> rd: ProfessionOID auf\ngültige Organisation\nprüfen
        |||
        rd -> oa: KIM Nachricht mit URL
        oa -> rd: URL in KIM-Nachricht öffnen
        |||
      end
      |||

    opt #MistyRose <size:15>Abbruch</size>
      rd -> wb: keine gültige ProfessionOID gefunden
      wb -> oa: Authentisierung fehlgeschlagen
      |||
    end

      |||
      rd-> rd: Organisation \nauthentifizieren
      |||
      rd -> rd : Prüfung auf existierenden Admin Account
      |||
        opt #MistyRose <size:15>Abbruch</size>
         rd -> oa: Organisation bereits authentifiziert und ein Admin-Account existiert bereits
         |||
        end
      |||
      rd - -> wb: status
        deactivate rd
      wb - -> oa: Verifizierung erfolgreich
      |||
      oa -> wb: Admin Account anlegen \n(Passwort + 2. Faktor)
      wb -> rd: POST I_Registration (Admin-Account Credentials + 2. Faktor)
      note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
        activate rd
      |||
      rd -> rd: Credentials-Policy prüfen
      |||
      rd -> rd: Org-Admin Account\nfür die Organisation \nanlegen
      rd - -> wb: status
       deactivate rd
      wb - -> oa: Account angelegt
       deactivate wb
      |||
end
|||
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>