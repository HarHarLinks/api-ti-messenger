<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2561px" preserveAspectRatio="none" style="width:1756px;height:2561px;background:#FFFFFF;" version="1.1" viewBox="0 0 1756 2561" width="1756px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2549.4297" style="stroke:#181818;stroke-width:0.5;" width="587.5" x="300" y="6"/><text fill="#000000" font-family="sans-serif" font-size="19" font-weight="bold" lengthAdjust="spacing" textLength="99" x="541.75" y="23.6362">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="640.75" y="25.0513"> </text><rect fill="#DCDCDC" height="1617.6484" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="225.1094"/><rect fill="#DCDCDC" height="423.6953" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="1947.1719"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="796.5" y="402.6953"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="971.5" y="470.2734"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1145.5" y="504.0625"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="298.3867"/><rect fill="#DCDCDC" height="968.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="840.3906"/><rect fill="#DCDCDC" height="191.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="2145.1328"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="402.6953"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="893.9688"/><rect fill="#F0F8FF" height="2250.3047" style="stroke:#000000;stroke-width:1.5;" width="1739" x="10" y="153.5625"/><rect fill="#ADD8E6" height="1293.3203" style="stroke:#000000;stroke-width:1.5;" width="1719" x="20" y="240.1094"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="30" y="611.6406"/><rect fill="#ADD8E6" height="441.5156" style="stroke:none;stroke-width:1.0;" width="1719" x="20" y="1091.9141"/><rect fill="#FFE4E1" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="30" y="1572.4297"/><rect fill="#F0F8FF" height="528.1094" style="stroke:none;stroke-width:1.0;" width="1739" x="10" y="1875.7578"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="30" y="2008.9609"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="136" x2="136" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="430" x2="430" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="801.5" x2="801.5" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="976.5" x2="976.5" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1150.5" x2="1150.5" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1357.5" x2="1357.5" y1="111.5625" y2="2445.8672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1647" x2="1647" y1="111.5625" y2="2445.8672"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="40" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="78.5" y="106.8457">Org-Admin</text><ellipse cx="136.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M136.5,21.5 L136.5,48.5 M123.5,29.5 L149.5,29.5 M136.5,48.5 L123.5,63.5 M136.5,48.5 L149.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="40" y="2463.4316">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="78.5" y="2486.7129">Org-Admin</text><ellipse cx="136.5" cy="2499.9297" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M136.5,2507.9297 L136.5,2534.9297 M123.5,2515.9297 L149.5,2515.9297 M136.5,2534.9297 L123.5,2549.9297 M136.5,2534.9297 L149.5,2549.9297 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="304" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="361.5" y="75.5645">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="311" y="98.8457">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="304" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="361.5" y="2470.4316">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="311" y="2493.7129">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="719.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="732.5" y="98.8457">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="719.5" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="732.5" y="2470.4316">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="894.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="925" y="98.8457">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="894.5" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="925" y="2470.4316">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1068.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1096" y="98.8457">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1068.5" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1096" y="2470.4316">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1242.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1249.5" y="98.8457">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1242.5" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1249.5" y="2470.4316">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1565" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1599" y="75.5645">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1595" y="98.8457">IDP-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1565" y="2444.8672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1599" y="2470.4316">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1595" y="2493.7129">IDP-Dienst</text><rect fill="#DCDCDC" height="1617.6484" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="225.1094"/><rect fill="#DCDCDC" height="423.6953" style="stroke:#000000;stroke-width:1.0;" width="10" x="425.5" y="1947.1719"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="796.5" y="402.6953"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="971.5" y="470.2734"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1145.5" y="504.0625"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="298.3867"/><rect fill="#DCDCDC" height="968.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="840.3906"/><rect fill="#DCDCDC" height="191.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="1353" y="2145.1328"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="402.6953"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1642" y="893.9688"/><path d="M10,153.5625 L74,153.5625 L74,160.6953 L64,170.6953 L10,170.6953 L10,153.5625 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2250.3047" style="stroke:#000000;stroke-width:1.5;" width="1739" x="10" y="153.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="166.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="171.5933">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="515" x="94" y="170.4141">Organisation nicht am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="609" y="171.5933">]</text><polygon fill="#000000" points="413.5,221.1094,423.5,225.1094,413.5,229.1094,417.5,225.1094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="419.5" y1="225.1094" y2="225.1094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="206" x="143.5" y="219.1001">Organisation verifizieren</text><path d="M20,240.1094 L84,240.1094 L84,247.2422 L74,257.2422 L20,257.2422 L20,240.1094 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1293.3203" style="stroke:#000000;stroke-width:1.5;" width="1719" x="20" y="240.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="253.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="258.1401">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="106" x="104" y="256.9609">Verfahren 1</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="210" y="258.1401">]</text><polygon fill="#000000" points="1341,294.3867,1351,298.3867,1341,302.3867,1345,298.3867" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="298.3867" y2="298.3867"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="119" x="442.5" y="292.3774">POST /register</text><path d="M1368,265.8672 L1368,312.8672 L1616,312.8672 L1616,275.8672 L1606,265.8672 L1368,265.8672 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1606,265.8672 L1606,275.8672 L1616,275.8672 L1606,265.8672 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1374" y="285.7188">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1374" y="304.3438">durch die gematik spezifiziert</text><polygon fill="#000000" points="446.5,339.9063,436.5,343.9063,446.5,347.9063,442.5,343.9063" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="343.9063" y2="343.9063"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="323" x="1028" y="337.897">Redirect to IDP Authorization Endpoint</text><polygon fill="#000000" points="1630,398.6953,1640,402.6953,1630,406.6953,1634,402.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1636" y1="402.6953" y2="402.6953"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="442.5" y="396.686">GET /authorize</text><polygon fill="#000000" points="817.5,432.4844,807.5,436.4844,817.5,440.4844,813.5,436.4844" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="811.5" x2="1641" y1="436.4844" y2="436.4844"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="1426" y="430.4751">Authentication challenge</text><polygon fill="#000000" points="959.5,466.2734,969.5,470.2734,959.5,474.2734,963.5,470.2734" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="806.5" x2="965.5" y1="470.2734" y2="470.2734"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="813.5" y="464.2642">SignDocument</text><polygon fill="#000000" points="1133.5,500.0625,1143.5,504.0625,1133.5,508.0625,1137.5,504.0625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="981.5" x2="1139.5" y1="504.0625" y2="504.0625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="139" x="988.5" y="498.0532">SICCT command</text><polygon fill="#000000" points="992.5,514.0625,982.5,518.0625,992.5,522.0625,988.5,518.0625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="986.5" x2="1149.5" y1="518.0625" y2="518.0625"/><polygon fill="#000000" points="817.5,567.6406,807.5,571.6406,817.5,575.6406,813.5,571.6406" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="811.5" x2="975.5" y1="571.6406" y2="571.6406"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="79" x="828.5" y="545.8423">Response</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="141" x="828.5" y="565.6313">signedDocument</text><path d="M30,611.6406 L100,611.6406 L100,618.7734 L90,628.7734 L30,628.7734 L30,611.6406 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="30" y="611.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="624.7075">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="628.5073">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="627.564">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="628.5073">]</text><polygon fill="#000000" points="147.5,653.0234,137.5,657.0234,147.5,661.0234,143.5,657.0234" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="795.5" y1="657.0234" y2="657.0234"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="222" x="567.5" y="651.0142">SMC-B nicht freigeschaltet</text><polygon fill="#000000" points="1630,743.8125,1640,747.8125,1630,751.8125,1634,747.8125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="1636" y1="747.8125" y2="747.8125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="808.5" y="741.8032">Authentication response</text><polygon fill="#000000" points="446.5,777.6016,436.5,781.6016,446.5,785.6016,442.5,781.6016" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1646" y1="781.6016" y2="781.6016"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="1484" y="775.5923">Authorization code</text><polygon fill="#000000" points="1341,836.3906,1351,840.3906,1341,844.3906,1345,840.3906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="840.3906" y2="840.3906"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="294" x="442.5" y="834.3813">POST /register (Authorization code)</text><polygon fill="#000000" points="1630,889.9688,1640,893.9688,1630,897.9688,1634,893.9688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1636" y1="893.9688" y2="893.9688"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="178" x="1370" y="868.1704">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="177" x="1370" y="887.9595">{authorization code}</text><polygon fill="#000000" points="1374,923.7578,1364,927.7578,1374,931.7578,1370,927.7578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1368" x2="1646" y1="927.7578" y2="927.7578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="72" x="1568" y="921.7485">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1045.9141" y2="1045.9141"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1045.9141" y2="1058.9141"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1058.9141" y2="1058.9141"/><polygon fill="#000000" points="1374,1054.9141,1364,1058.9141,1374,1062.9141,1370,1058.9141" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="92" x="1370" y="980.5376">enthaltene</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="149" x="1370" y="1000.3267">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="170" x="1370" y="1020.1157">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="1370" y="1039.9048">prüfen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1739" y1="1092.9141" y2="1092.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="1108.9448">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="106" x="30" y="1107.7656">Verfahren 2</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="136" y="1108.9448">]</text><polygon fill="#000000" points="1341,1134.3281,1351,1138.3281,1341,1142.3281,1345,1138.3281" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="1347" y1="1138.3281" y2="1138.3281"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="337" x="143.5" y="1132.3188">KIM-Adresse in Eingabemaske eintragen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1191.9063" y2="1191.9063"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1191.9063" y2="1204.9063"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1204.9063" y2="1204.9063"/><polygon fill="#000000" points="1374,1200.9063,1364,1204.9063,1374,1208.9063,1370,1204.9063" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="228" x="1370" y="1166.1079">Abfrage des LDAP-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="208" x="1370" y="1185.897">Eintrags zur KIM-Adresse</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1283.4844" y2="1283.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1283.4844" y2="1296.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1296.4844" y2="1296.4844"/><polygon fill="#000000" points="1374,1292.4844,1364,1296.4844,1374,1300.4844,1370,1296.4844" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="238" x="1370" y="1257.686">Speicherung der telematikId</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="1370" y="1277.4751">und der professionOID</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1394.8516" y2="1394.8516"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1394.8516" y2="1407.8516"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1407.8516" y2="1407.8516"/><polygon fill="#000000" points="1374,1403.8516,1364,1407.8516,1374,1411.8516,1370,1407.8516" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="149" x="1370" y="1349.2642">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="170" x="1370" y="1369.0532">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="1370" y="1388.8423">prüfen</text><polygon fill="#000000" points="147.5,1462.6406,137.5,1466.6406,147.5,1470.6406,143.5,1466.6406" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="1352" y1="1466.6406" y2="1466.6406"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="191" x="1155" y="1460.6313">KIM Nachricht mit URL</text><polygon fill="#000000" points="1341,1496.4297,1351,1500.4297,1341,1504.4297,1345,1500.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="1347" y1="1500.4297" y2="1500.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="238" x="143.5" y="1494.4204">URL in KIM-Nachricht öffnen</text><path d="M30,1572.4297 L100,1572.4297 L100,1579.5625 L90,1589.5625 L30,1589.5625 L30,1572.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="30" y="1572.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="1585.4966">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="1589.2964">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="1588.353">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="1589.2964">]</text><polygon fill="#000000" points="446.5,1613.8125,436.5,1617.8125,446.5,1621.8125,442.5,1617.8125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="440.5" x2="1352" y1="1617.8125" y2="1617.8125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="1031" y="1611.8032">keine gültige ProfessionOID gefunden</text><polygon fill="#000000" points="147.5,1647.6016,137.5,1651.6016,147.5,1655.6016,143.5,1651.6016" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="424.5" y1="1651.6016" y2="1651.6016"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="153.5" y="1645.5923">Authentisierung fehlgeschlagen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="1762.1797" y2="1762.1797"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="1762.1797" y2="1775.1797"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="1775.1797" y2="1775.1797"/><polygon fill="#000000" points="1374,1771.1797,1364,1775.1797,1374,1779.1797,1370,1775.1797" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="107" x="1370" y="1736.3813">Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="134" x="1370" y="1756.1704">authentifizieren</text><polygon fill="#000000" points="446.5,1804.9688,436.5,1808.9688,446.5,1812.9688,442.5,1808.9688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="1808.9688" y2="1808.9688"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1300" y="1802.9595">status</text><polygon fill="#000000" points="147.5,1838.7578,137.5,1842.7578,147.5,1846.7578,143.5,1842.7578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141.5" x2="429.5" y1="1842.7578" y2="1842.7578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="200" x="223.5" y="1836.7485">Verifizierung erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1749" y1="1876.7578" y2="1876.7578"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="1892.7886">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="465" x="20" y="1891.6094">Organisation am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="485" y="1892.7886">]</text><polygon fill="#000000" points="413.5,1943.1719,423.5,1947.1719,413.5,1951.1719,417.5,1947.1719" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="136.5" x2="419.5" y1="1947.1719" y2="1947.1719"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="197" x="143.5" y="1941.1626">Admin Account anlegen</text><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="477.5" y1="1980.9609" y2="1980.9609"/><line style="stroke:#000000;stroke-width:1.0;" x1="477.5" x2="477.5" y1="1980.9609" y2="1993.9609"/><line style="stroke:#000000;stroke-width:1.0;" x1="436.5" x2="477.5" y1="1993.9609" y2="1993.9609"/><polygon fill="#000000" points="446.5,1989.9609,436.5,1993.9609,446.5,1997.9609,442.5,1993.9609" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="347" x="442.5" y="1974.9517">Prüfung auf existierenden Admin Account</text><path d="M30,2008.9609 L100,2008.9609 L100,2016.0938 L90,2026.0938 L30,2026.0938 L30,2008.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="30" y="2008.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="45" y="2022.0278">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="115" y="2025.8276">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="120" y="2024.8843">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="187" y="2025.8276">]</text><polygon fill="#000000" points="147.5,2050.3438,137.5,2054.3438,147.5,2058.3438,143.5,2054.3438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="141.5" x2="424.5" y1="2054.3438" y2="2054.3438"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="261" x="157.5" y="2048.3345">Admin Account existiert bereits</text><polygon fill="#000000" points="1341,2141.1328,1351,2145.1328,1341,2149.1328,1345,2145.1328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="435.5" x2="1347" y1="2145.1328" y2="2145.1328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="371" x="442.5" y="2139.1235">POST /register (id_token, Client-Credentials)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="2178.9219" y2="2178.9219"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="2178.9219" y2="2191.9219"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="2191.9219" y2="2191.9219"/><polygon fill="#000000" points="1374,2187.9219,1364,2191.9219,1374,2195.9219,1370,2191.9219" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="1370" y="2172.9126">Client-Credentials-Policy prüfen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1363" x2="1405" y1="2290.2891" y2="2290.2891"/><line style="stroke:#000000;stroke-width:1.0;" x1="1405" x2="1405" y1="2290.2891" y2="2303.2891"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364" x2="1405" y1="2303.2891" y2="2303.2891"/><polygon fill="#000000" points="1374,2299.2891,1364,2303.2891,1374,2307.2891,1370,2303.2891" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="161" x="1370" y="2244.7017">Org-Admin Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="1370" y="2264.4907">für die Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="67" x="1370" y="2284.2798">anlegen</text><polygon fill="#000000" points="446.5,2333.0781,436.5,2337.0781,446.5,2341.0781,442.5,2337.0781" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="1357" y1="2337.0781" y2="2337.0781"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1300" y="2331.0688">status</text><polygon fill="#000000" points="147.5,2366.8672,137.5,2370.8672,147.5,2374.8672,143.5,2370.8672" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141.5" x2="429.5" y1="2370.8672" y2="2370.8672"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="279.5" y="2364.8579">Account angelegt</text><!--MD5=[dc39b1db9ea05fde45199b1fe899dd97]
@startuml "Authentisieren einer Organisation am TI-Messenger-Dienst"
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}

  actor oa as "Akteur in der Rolle\nOrg-Admin"
    box <size:19>Endgerät</size> #WhiteSmoke
    participant wb as "Frontend des \nRegistrierungs-Dienstes"
    participant au as "Authenticator"
    end box
  participant ko as "Konnektor"
  participant kt as "eHealth KT"
  participant rd as "Registrierungs-Dienst"
  participant ip as "zentraler \nIDP-Dienst"

|||
alt#LightGrey #AliceBlue <size:16>Organisation nicht am Registrierungs-Dienst authentisiert</size>
|||
      oa -> wb: Organisation verifizieren
      alt#LightGrey #LightBlue <size:16>Verfahren 1</size>
          activate wb
        wb -> rd:POST /register
        note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
          activate rd
        rd - -> wb: Redirect to IDP Authorization Endpoint
          deactivate rd
        |||
        wb -> ip: GET /authorize
          activate au
          activate ip
        ip -> au: Authentication challenge
        au -> ko: SignDocument
          activate ko
        ko -> kt: SICCT command
          activate kt
        kt - -> ko
          deactivate kt
        ko - -> au: Response \nsignedDocument
        |||
          deactivate ko

      opt #MistyRose <size:15>Abbruch</size>
        au -> oa: SMC-B nicht freigeschaltet
        |||
      end
        |||
        au - ->ip: Authentication response
          deactivate au
        ip - -> wb: Authorization code
          deactivate ip
        |||
        wb -> rd: POST /register (Authorization code)
          activate rd
        rd -> ip: POST /tokenEndpoint\n{authorization code}
          activate ip
        ip - -> rd: id_token
          deactivate ip
        |||
        rd -> rd: enthaltene \nProfessionOID auf \ngültige Organisation \nprüfen
        |||
      else <size:16>Verfahren 2</size>
        oa -> rd: KIM-Adresse in Eingabemaske eintragen
        rd -> rd: Abfrage des LDAP-Directory\nEintrags zur KIM-Adresse
        |||
        rd -> rd: Speicherung der telematikId\nund der professionOID
        |||
        rd -> rd: ProfessionOID auf\ngültige Organisation\nprüfen
        |||
        rd -> oa: KIM Nachricht mit URL
        oa -> rd: URL in KIM-Nachricht öffnen
        |||
      end
      |||

    opt #MistyRose <size:15>Abbruch</size>
      rd -> wb: keine gültige ProfessionOID gefunden
      wb -> oa: Authentisierung fehlgeschlagen
      |||
    end

      |||
      rd-> rd: Organisation \nauthentifizieren
      rd - -> wb: status
        deactivate rd
      wb - -> oa: Verifizierung erfolgreich
        deactivate wb
      |||

      else <size:16>Organisation am Registrierungs-Dienst authentisiert</size>
        |||
        oa -> wb: Admin Account anlegen
          activate wb
        wb -> wb: Prüfung auf existierenden Admin Account
         opt #MistyRose <size:15>Abbruch</size>
         wb -> oa: Admin Account existiert bereits
         |||
        end
         |||
        wb -> rd: POST /register (id_token, Client-Credentials)
          activate rd
        rd -> rd: Client-Credentials-Policy prüfen
        |||
        rd -> rd: Org-Admin Account\nfür die Organisation \nanlegen
        rd - -> wb: status
          deactivate rd
        wb - -> oa: Account angelegt
          deactivate wb
        |||
end
|||
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>