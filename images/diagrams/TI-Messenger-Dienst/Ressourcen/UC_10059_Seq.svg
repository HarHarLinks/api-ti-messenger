<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2544px" preserveAspectRatio="none" style="width:1830px;height:2544px;background:#FFFFFF;" version="1.1" viewBox="0 0 1830 2544" width="1830px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2532.6484" style="stroke:#181818;stroke-width:0.5;" width="222" x="265.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="93" x="330" y="22.708">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="330" y="39.02"> </text><rect fill="#F5F5F5" height="2532.6484" style="stroke:#181818;stroke-width:0.5;" width="670" x="758.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="991" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1191" y="23.8872"> </text><rect fill="#DCDCDC" height="2103.2109" style="stroke:#000000;stroke-width:1.0;" width="10" x="371.5" y="315.875"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="864.5" y="1695.625"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="864.5" y="2073.5625"/><rect fill="#DCDCDC" height="349.4922" style="stroke:#000000;stroke-width:1.0;" width="10" x="1088.5" y="1110.5156"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1312.5" y="1795.9922"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1312.5" y="2173.9297"/><rect fill="#DCDCDC" height="112.0977" style="stroke:#000000;stroke-width:1.0;" width="10" x="1546" y="651.6445"/><rect fill="#DCDCDC" height="151.6758" style="stroke:#000000;stroke-width:1.0;" width="10" x="1546" y="900.0508"/><rect fill="#F0F8FF" height="1050.7656" style="stroke:#000000;stroke-width:1.5;" width="1814" x="10" y="442.2422"/><rect fill="#ADD8E6" height="335.5313" style="stroke:#000000;stroke-width:1.5;" width="1794" x="20" y="495"/><rect fill="#FFE4E1" height="113.3359" style="stroke:#000000;stroke-width:1.5;" width="1190.5" x="20" y="1222.3047"/><rect height="855.0781" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1491.5" x="20" y="1532.0078"/><rect height="358.7266" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1196" x="259.5" y="1584.6328"/><rect height="338.9375" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1242" x="259.5" y="1982.3594"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="130.9297" y2="2429.0859"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="376.5" x2="376.5" y1="130.9297" y2="2429.0859"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="869.5" x2="869.5" y1="130.9297" y2="2429.0859"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1093.5" x2="1093.5" y1="130.9297" y2="2429.0859"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1317.5" x2="1317.5" y1="130.9297" y2="2429.0859"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1550.5" x2="1550.5" y1="130.9297" y2="2429.0859"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="102.9316">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="68.5" y="126.2129">Org-Admin</text><ellipse cx="126.5" cy="32.8672" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,40.8672 L126.5,67.8672 M113.5,48.8672 L139.5,48.8672 M126.5,67.8672 L113.5,82.8672 M126.5,67.8672 L139.5,82.8672 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="2446.6504">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="68.5" y="2469.9316">Org-Admin</text><ellipse cx="126.5" cy="2483.1484" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,2491.1484 L126.5,2518.1484 M113.5,2499.1484 L139.5,2499.1484 M126.5,2518.1484 L113.5,2533.1484 M126.5,2518.1484 L139.5,2533.1484 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="83.8438" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="269.5" y="46.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="198" x="277.5" y="71.6504">TI-Messenger-Client</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="150" x="301.5" y="94.9316">mit Org-Admin</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="141" x="306" y="118.2129">Funktionalität</text><rect fill="#EFEFFF" height="83.8438" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="269.5" y="2428.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="198" x="277.5" y="2453.6504">TI-Messenger-Client</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="150" x="301.5" y="2476.9316">mit Org-Admin</text><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="141" x="306" y="2500.2129">Funktionalität</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="762.5" y="92.6484"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="108" x="815.5" y="118.2129">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="762.5" y="2428.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="108" x="815.5" y="2453.6504">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="986.5" y="92.6484"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="128" x="1029.5" y="118.2129">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="986.5" y="2428.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="128" x="1029.5" y="2453.6504">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1210.5" y="92.6484"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="145" x="1245" y="118.2129">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1210.5" y="2428.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="145" x="1245" y="2453.6504">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1435.5" y="92.6484"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="217" x="1442.5" y="118.2129">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1435.5" y="2428.0859"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="217" x="1442.5" y="2453.6504">Registrierungs-Dienst</text><rect fill="#DCDCDC" height="2103.2109" style="stroke:#000000;stroke-width:1.0;" width="10" x="371.5" y="315.875"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="864.5" y="1695.625"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="864.5" y="2073.5625"/><rect fill="#DCDCDC" height="349.4922" style="stroke:#000000;stroke-width:1.0;" width="10" x="1088.5" y="1110.5156"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1312.5" y="1795.9922"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1312.5" y="2173.9297"/><rect fill="#DCDCDC" height="112.0977" style="stroke:#000000;stroke-width:1.0;" width="10" x="1546" y="651.6445"/><rect fill="#DCDCDC" height="151.6758" style="stroke:#000000;stroke-width:1.0;" width="10" x="1546" y="900.0508"/><path d="M23,170.9297 L23,219.9297 L479,219.9297 L479,180.9297 L469,170.9297 L23,170.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M469,170.9297 L469,180.9297 L479,180.9297 L469,170.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="386" x="29" y="191.7095">Die Organisation hat einen Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="435" x="29" y="211.4985">bereitgestellt bekommen, der Teil der Föderation ist</text><polygon fill="#000000" points="359.5,311.875,369.5,315.875,359.5,319.875,363.5,315.875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="365.5" y1="315.875" y2="315.875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="168" x="133.5" y="270.2876">FHIR Ressourcen im</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="133.5" y="290.0767">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="94" x="133.5" y="309.8657">hinzufügen</text><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="423.5" y1="389.2422" y2="389.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="423.5" x2="423.5" y1="389.2422" y2="402.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="382.5" x2="423.5" y1="402.2422" y2="402.2422"/><polygon fill="#000000" points="392.5,398.2422,382.5,402.2422,392.5,406.2422,388.5,402.2422" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="167" x="388.5" y="343.6548">Prüfung, ob gültiges</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="388.5" y="363.4438">owner-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="64" x="388.5" y="383.2329">vorliegt</text><path d="M10,442.2422 L74,442.2422 L74,449.375 L64,459.375 L10,459.375 L10,442.2422 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1050.7656" style="stroke:#000000;stroke-width:1.5;" width="1814" x="10" y="442.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="455.3091">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="460.2729">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="556" x="94" y="459.0938">kein gültiges owner-accesstoken für Schreibzugriff vorhanden</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="650" y="460.2729">]</text><path d="M20,495 L84,495 L84,502.1328 L74,512.1328 L20,512.1328 L20,495 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="335.5313" style="stroke:#000000;stroke-width:1.5;" width="1794" x="20" y="495"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="508.0669">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="513.0308">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="481" x="104" y="511.8516">Akteur ist nicht am Registrierungs-Dienst angemeldet</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="585" y="513.0308">]</text><polygon fill="#000000" points="359.5,602.125,369.5,606.125,359.5,610.125,363.5,606.125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="365.5" y1="606.125" y2="606.125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="216" x="133.5" y="560.5376">Mit einem Admin-Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="213" x="133.5" y="580.3267">am Registrierungs-Dienst</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="84" x="133.5" y="600.1157">anmelden</text><polygon fill="#000000" points="1534,647.6445,1544,651.6445,1534,655.6445,1538,651.6445" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="1540" y1="651.6445" y2="651.6445"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="258" x="388.5" y="645.6353">POST /login (Client-Credential)</text><path d="M1561,619.125 L1561,666.125 L1809,666.125 L1809,629.125 L1799,619.125 L1561,619.125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1799,619.125 L1799,629.125 L1809,629.125 L1799,619.125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1567" y="638.9766">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1567" y="657.6016">durch die gematik spezifiziert</text><line style="stroke:#000000;stroke-width:1.0;" x1="1556" x2="1598" y1="716.9531" y2="716.9531"/><line style="stroke:#000000;stroke-width:1.0;" x1="1598" x2="1598" y1="716.9531" y2="729.9531"/><line style="stroke:#000000;stroke-width:1.0;" x1="1557" x2="1598" y1="729.9531" y2="729.9531"/><polygon fill="#000000" points="1567,725.9531,1557,729.9531,1567,733.9531,1563,729.9531" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1563" y="691.1548">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="143" x="1563" y="710.9438">Client-Credential</text><polygon fill="#000000" points="392.5,759.7422,382.5,763.7422,392.5,767.7422,388.5,763.7422" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="1550" y1="763.7422" y2="763.7422"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1493" y="757.7329">status</text><polygon fill="#000000" points="137.5,793.5313,127.5,797.5313,137.5,801.5313,133.5,797.5313" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="370.5" y1="797.5313" y2="797.5313"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="195" x="169.5" y="791.522">Erfolgreich angemeldet</text><polygon fill="#000000" points="1534,896.0508,1544,900.0508,1534,904.0508,1538,900.0508" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="1540" y1="900.0508" y2="900.0508"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="462" x="388.5" y="894.0415">ID_TOKEN anfragen (z. B. GET /regserv/request_Token)</text><path d="M1561,867.5313 L1561,914.5313 L1809,914.5313 L1809,877.5313 L1799,867.5313 L1561,867.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1799,867.5313 L1799,877.5313 L1809,877.5313 L1799,867.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1567" y="887.3828">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1567" y="906.0078">durch die gematik spezifiziert</text><line style="stroke:#000000;stroke-width:1.0;" x1="1556" x2="1598" y1="1004.9375" y2="1004.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1598" x2="1598" y1="1004.9375" y2="1017.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1557" x2="1598" y1="1017.9375" y2="1017.9375"/><polygon fill="#000000" points="1567,1013.9375,1557,1017.9375,1567,1021.9375,1563,1017.9375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="139" x="1563" y="939.561">Verifizierung des</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="64" x="1563" y="959.3501">Akteurs</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="104" x="1563" y="979.1392">(Anhand des</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="143" x="1563" y="998.9282">Nutzer-Accounts)</text><polygon fill="#000000" points="392.5,1047.7266,382.5,1051.7266,392.5,1055.7266,388.5,1051.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="1550" y1="1051.7266" y2="1051.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="678" x="866" y="1045.7173">RegService-OpenID-Token {telematikID, professionOID, Signaturzertifikat (x5c)}</text><polygon fill="#000000" points="1076.5,1106.5156,1086.5,1110.5156,1076.5,1114.5156,1080.5,1110.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="1082.5" y1="1110.5156" y2="1110.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="593" x="388.5" y="1104.5063">GET /owner-authenticate (Auth Header mit RegService-OpenID-Token)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1098.5" x2="1140.5" y1="1169.3047" y2="1169.3047"/><line style="stroke:#000000;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="1169.3047" y2="1182.3047"/><line style="stroke:#000000;stroke-width:1.0;" x1="1099.5" x2="1140.5" y1="1182.3047" y2="1182.3047"/><polygon fill="#000000" points="1109.5,1178.3047,1099.5,1182.3047,1109.5,1186.3047,1105.5,1182.3047" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="155" x="1105.5" y="1163.2954">Prüfung des Token</text><path d="M20,1222.3047 L90,1222.3047 L90,1229.4375 L80,1239.4375 L20,1239.4375 L20,1222.3047 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="113.3359" style="stroke:#000000;stroke-width:1.5;" width="1190.5" x="20" y="1222.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="1235.3716">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="1240.3354">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="74" x="110" y="1239.1563">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="184" y="1240.3354">]</text><polygon fill="#000000" points="392.5,1264.8516,382.5,1268.8516,392.5,1272.8516,388.5,1268.8516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="1087.5" y1="1268.8516" y2="1268.8516"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="208" x="873.5" y="1262.8423">Tokensignatur fehlerhaft</text><polygon fill="#000000" points="137.5,1298.6406,127.5,1302.6406,137.5,1306.6406,133.5,1302.6406" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="370.5" y1="1302.6406" y2="1302.6406"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="163" x="201.5" y="1296.6313">keine Berechtigung</text><line style="stroke:#000000;stroke-width:1.0;" x1="1098.5" x2="1140.5" y1="1413.2188" y2="1413.2188"/><line style="stroke:#000000;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="1413.2188" y2="1426.2188"/><line style="stroke:#000000;stroke-width:1.0;" x1="1099.5" x2="1140.5" y1="1426.2188" y2="1426.2188"/><polygon fill="#000000" points="1109.5,1422.2188,1099.5,1426.2188,1109.5,1430.2188,1105.5,1426.2188" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="66" x="1105.5" y="1387.4204">erzeuge</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1105.5" y="1407.2095">owner-accesstoken</text><polygon fill="#000000" points="392.5,1456.0078,382.5,1460.0078,392.5,1464.0078,388.5,1460.0078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="1092.5" y1="1460.0078" y2="1460.0078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="927.5" y="1453.9985">owner-accesstoken</text><path d="M20,1532.0078 L347,1532.0078 L347,1542.6328 L337,1552.6328 L20,1552.6328 L20,1532.0078 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="855.0781" style="stroke:#000000;stroke-width:1.5;" width="1491.5" x="20" y="1532.0078"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="282" x="35" y="1547.8594">FHIR-Directory Eintrag erstellen</text><path d="M259.5,1584.6328 L683.5,1584.6328 L683.5,1595.2578 L673.5,1605.2578 L259.5,1605.2578 L259.5,1584.6328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="358.7266" style="stroke:#000000;stroke-width:1.5;" width="1196" x="259.5" y="1584.6328"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="379" x="274.5" y="1600.4844">FHIR-Ressource der Organisation anzeigen</text><polygon fill="#000000" points="852.5,1691.625,862.5,1695.625,852.5,1699.625,856.5,1695.625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="858.5" y1="1695.625" y2="1695.625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="296" x="388.5" y="1650.0376">POST /owner/HealthcareService/?...</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="333" x="388.5" y="1669.8267">Finde Datensatz für eigene TelematikID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="338" x="388.5" y="1689.6157">Authorization Bearer owner-accesstoken</text><line style="stroke:#000000;stroke-width:1.0;" x1="874.5" x2="916.5" y1="1749.2031" y2="1749.2031"/><line style="stroke:#000000;stroke-width:1.0;" x1="916.5" x2="916.5" y1="1749.2031" y2="1762.2031"/><line style="stroke:#000000;stroke-width:1.0;" x1="875.5" x2="916.5" y1="1762.2031" y2="1762.2031"/><polygon fill="#000000" points="885.5,1758.2031,875.5,1762.2031,885.5,1766.2031,881.5,1762.2031" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="881.5" y="1723.4048">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="881.5" y="1743.1938">owner-accesstoken</text><polygon fill="#000000" points="1300.5,1791.9922,1310.5,1795.9922,1300.5,1799.9922,1304.5,1795.9922" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="874.5" x2="1306.5" y1="1795.9922" y2="1795.9922"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="881.5" y="1789.9829">HTTPS Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1322.5" x2="1364.5" y1="1829.7813" y2="1829.7813"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364.5" x2="1364.5" y1="1829.7813" y2="1842.7813"/><line style="stroke:#000000;stroke-width:1.0;" x1="1323.5" x2="1364.5" y1="1842.7813" y2="1842.7813"/><polygon fill="#000000" points="1333.5,1838.7813,1323.5,1842.7813,1333.5,1846.7813,1329.5,1842.7813" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="1329.5" y="1823.772">suche Eintrag</text><polygon fill="#000000" points="885.5,1872.5703,875.5,1876.5703,885.5,1880.5703,881.5,1876.5703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="879.5" x2="1316.5" y1="1876.5703" y2="1876.5703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1178.5" y="1870.561">result body json</text><polygon fill="#000000" points="392.5,1906.3594,382.5,1910.3594,392.5,1914.3594,388.5,1910.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="868.5" y1="1910.3594" y2="1910.3594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="734.5" y="1904.3501">HTTPS Forward</text><path d="M259.5,1982.3594 L751.5,1982.3594 L751.5,1992.9844 L741.5,2002.9844 L259.5,2002.9844 L259.5,1982.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="338.9375" style="stroke:#000000;stroke-width:1.5;" width="1242" x="259.5" y="1982.3594"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="447" x="274.5" y="1998.2109">FHIR-Ressource der Organisation erstellen/ändern</text><polygon fill="#000000" points="852.5,2069.5625,862.5,2073.5625,852.5,2077.5625,856.5,2073.5625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="858.5" y1="2073.5625" y2="2073.5625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="459" x="388.5" y="2047.7642">FHIR-Operationen um eigenen Datensatz zu verwalten</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="338" x="388.5" y="2067.5532">Authorization Bearer owner-accesstoken</text><line style="stroke:#000000;stroke-width:1.0;" x1="874.5" x2="916.5" y1="2127.1406" y2="2127.1406"/><line style="stroke:#000000;stroke-width:1.0;" x1="916.5" x2="916.5" y1="2127.1406" y2="2140.1406"/><line style="stroke:#000000;stroke-width:1.0;" x1="875.5" x2="916.5" y1="2140.1406" y2="2140.1406"/><polygon fill="#000000" points="885.5,2136.1406,875.5,2140.1406,885.5,2144.1406,881.5,2140.1406" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="881.5" y="2101.3423">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="881.5" y="2121.1313">owner-accesstoken</text><polygon fill="#000000" points="1300.5,2169.9297,1310.5,2173.9297,1300.5,2177.9297,1304.5,2173.9297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="874.5" x2="1306.5" y1="2173.9297" y2="2173.9297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="881.5" y="2167.9204">HTTPS Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1322.5" x2="1364.5" y1="2207.7188" y2="2207.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="1364.5" x2="1364.5" y1="2207.7188" y2="2220.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="1323.5" x2="1364.5" y1="2220.7188" y2="2220.7188"/><polygon fill="#000000" points="1333.5,2216.7188,1323.5,2220.7188,1333.5,2224.7188,1329.5,2220.7188" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="1329.5" y="2201.7095">Eintrag hinzufügen</text><polygon fill="#000000" points="885.5,2250.5078,875.5,2254.5078,885.5,2258.5078,881.5,2254.5078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="879.5" x2="1316.5" y1="2254.5078" y2="2254.5078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1178.5" y="2248.4985">result body json</text><polygon fill="#000000" points="392.5,2284.2969,382.5,2288.2969,392.5,2292.2969,388.5,2288.2969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386.5" x2="868.5" y1="2288.2969" y2="2288.2969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="734.5" y="2282.2876">HTTPS Forward</text><polygon fill="#000000" points="137.5,2350.0859,127.5,2354.0859,137.5,2358.0859,133.5,2354.0859" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="370.5" y1="2354.0859" y2="2354.0859"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="313.5" y="2348.0767">status</text><!--MD5=[9d567a2457f013049cdfe6c186b97a77]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nOrg-Admin"
    box <size:18>Endgerät</size>\n #WhiteSmoke 
    participant C as "TI-Messenger-Client\n mit Org-Admin \nFunktionalität"
    end box
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant FP as "FHIR-Proxy"
      participant Auth as "Auth-Service"
      participant VZD as "FHIR-Directory"
    end box
    participant RD as "Registrierungs-Dienst"

|||
note over U, C: <size:17>Die Organisation hat einen Messenger-Service\n<size:17>bereitgestellt bekommen, der Teil der Föderation ist</size>
|||

U->C: FHIR Ressourcen im \nVZD-FHIR-Directory \nhinzufügen
  Activate C
C->C: Prüfung, ob gültiges \nowner-accesstoken \nvorliegt

|||
alt#LightGrey #AliceBlue <size:16>kein gültiges owner-accesstoken für Schreibzugriff vorhanden</size>
|||
  alt#LightGrey #LightBlue <size:16>Akteur ist nicht am Registrierungs-Dienst angemeldet</size>
    |||
    U->C: Mit einem Admin-Account \nam Registrierungs-Dienst \nanmelden
    C->RD: POST /login (Client-Credential)
    note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
      activate RD
    RD->RD: prüfe \nClient-Credential
    RD- ->C: status
      deactivate RD
    C- ->U: Erfolgreich angemeldet
    |||
  end
  |||
  C -> RD: ID_TOKEN anfragen (z. B. GET /regserv/request_Token)
  note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
    activate RD 
  RD -> RD: Verifizierung des \nAkteurs \n(Anhand des \nNutzer-Accounts)
  RD - -> C: RegService-OpenID-Token {telematikID, professionOID, Signaturzertifikat (x5c)}
    deactivate RD
  |||
  C->Auth: GET /owner-authenticate (Auth Header mit RegService-OpenID-Token)
    activate Auth
    |||
  Auth -> Auth: Prüfung des Token
  |||
    opt#LightGrey #MistyRose <size:16>Abbruch</size>
    Auth - -> C: Tokensignatur fehlerhaft
    C - -> U: keine Berechtigung
    |||
    end
  |||
  Auth->Auth: erzeuge \nowner-accesstoken
  Auth- ->C: owner-accesstoken
  ||| 
    deactivate Auth
end
|||

group <size:16>FHIR-Directory Eintrag erstellen</size>
  |||
  group <size:16>FHIR-Ressource der Organisation anzeigen</size>
  |||
  C->FP: POST /owner/HealthcareService/?... \nFinde Datensatz für eigene TelematikID \nAuthorization Bearer owner-accesstoken
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTPS Forward
    Activate VZD
  VZD->VZD: suche Eintrag
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTPS Forward
    Deactivate FP
  |||
  end

  |||
  group <size:16>FHIR-Ressource der Organisation erstellen/ändern</size>
  |||
  C->FP: FHIR-Operationen um eigenen Datensatz zu verwalten \nAuthorization Bearer owner-accesstoken
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTPS Forward
    Activate VZD
  VZD->VZD: Eintrag hinzufügen
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTPS Forward
     Deactivate FP
  |||
  end
  C- ->U: status    
  |||
end
|||

  Deactivate C
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>