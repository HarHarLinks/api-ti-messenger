<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2004px" preserveAspectRatio="none" style="width:1371px;height:2004px;background:#FFFFFF;" version="1.1" viewBox="0 0 1371 2004" width="1371px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="1992.5234" style="stroke:#181818;stroke-width:0.5;" width="222" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="170" x="42" y="24.6855">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="42" y="42.1357"> </text><rect fill="#F5F5F5" height="1992.5234" style="stroke:#181818;stroke-width:0.5;" width="446" x="882" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="171" x="1017.5" y="24.6855">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="1188.5" y="25.7842"> </text><rect fill="#DCDCDC" height="895.5859" style="stroke:#000000;stroke-width:1.0;" width="10" x="122" y="1034.7813"/><rect fill="#DCDCDC" height="824.7422" style="stroke:#000000;stroke-width:1.0;" width="10" x="556" y="99.1484"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="561" y="816.5078"/><rect fill="#DCDCDC" height="814.3867" style="stroke:#000000;stroke-width:1.0;" width="10" x="556" y="1082.5977"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="561" y="1553.7578"/><rect fill="none" height="776.6172" style="stroke:#000000;stroke-width:1.5;" width="950" x="404" y="154.2734"/><rect fill="none" height="739.1406" style="stroke:#000000;stroke-width:1.5;" width="930" x="414" y="184.75"/><rect fill="none" height="529.6797" style="stroke:#000000;stroke-width:1.5;" width="910" x="424" y="387.2109"/><rect fill="none" height="390.7266" style="stroke:#000000;stroke-width:1.5;" width="494" x="434" y="519.1641"/><rect fill="#FFB6C1" height="66.7344" style="stroke:#000000;stroke-width:1.5;" width="419" x="444" y="549.6406"/><rect fill="none" height="180.625" style="stroke:#000000;stroke-width:1.5;" width="474" x="444" y="722.2656"/><rect fill="none" height="124.9531" style="stroke:#000000;stroke-width:1.5;" width="890" x="444" y="1135.0313"/><rect fill="#FFB6C1" height="216.0078" style="stroke:#000000;stroke-width:1.5;" width="788" x="10" y="1273.9844"/><rect fill="none" height="242.8438" style="stroke:#000000;stroke-width:1.5;" width="668" x="10" y="1622.1406"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="127" x2="127" y1="89.1484" y2="1955.3672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="561" x2="561" y1="89.1484" y2="1955.3672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="993" x2="993" y1="89.1484" y2="1955.3672"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1217" x2="1217" y1="89.1484" y2="1955.3672"/><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="20" y="48.9922"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="155" x="49.5" y="76.7539">Messenger-Proxy</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="20" y="1954.3672"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="155" x="49.5" y="1982.1289">Messenger-Proxy</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="454" y="48.9922"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="188" x="467" y="76.7539">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="454" y="1954.3672"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="188" x="467" y="1982.1289">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="886" y="48.9922"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="102" x="942" y="76.7539">FHIR-Proxy</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="886" y="1954.3672"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="102" x="942" y="1982.1289">FHIR-Proxy</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1110" y="48.9922"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="127" x="1153.5" y="76.7539">OAuth-Service</text><rect fill="#EFEFFF" height="39.1563" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1110" y="1954.3672"/><text fill="#000000" font-family="sans-serif" font-size="20" lengthAdjust="spacing" textLength="127" x="1153.5" y="1982.1289">OAuth-Service</text><rect fill="#DCDCDC" height="895.5859" style="stroke:#000000;stroke-width:1.0;" width="10" x="122" y="1034.7813"/><rect fill="#DCDCDC" height="824.7422" style="stroke:#000000;stroke-width:1.0;" width="10" x="556" y="99.1484"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="561" y="816.5078"/><rect fill="#DCDCDC" height="814.3867" style="stroke:#000000;stroke-width:1.0;" width="10" x="556" y="1082.5977"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="561" y="1553.7578"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1364" x="0" y="122.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1364" y1="122.2109" y2="122.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1364" y1="125.2109" y2="125.2109"/><rect fill="#EEEEEE" height="28.125" style="stroke:#000000;stroke-width:2.0;" width="98" x="633" y="109.1484"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="80" x="639" y="129.7578">scheduled</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="719" y="130.417"> </text><path d="M404,154.2734 L477,154.2734 L477,162.625 L467,172.625 L404,172.625 L404,154.2734 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="776.6172" style="stroke:#000000;stroke-width:1.5;" width="950" x="404" y="154.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="419" y="168.7686">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="492" y="173.9814">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="49" x="496" y="172.8828">alle 1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="545" y="173.9814">]</text><path d="M414,184.75 L475,184.75 L475,193.1016 L465,203.1016 L414,203.1016 L414,184.75 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="739.1406" style="stroke:#000000;stroke-width:1.5;" width="930" x="414" y="184.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="429" y="199.2451">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="490" y="204.458">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="455" x="494" y="203.3594">HealthState_VZD=gesund ODER Alter_Föderationsliste&gt;=1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="949" y="204.458">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="876" x="451" y="233.2266"/><path d="M451,233.2266 L513,233.2266 L513,241.2266 L503,251.2266 L451,251.2266 L451,233.2266 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="464" y="248.7217">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="705" y="271.8359">Provider authentifizieren und Föderationsliste abrufen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="414" x2="1344" y1="310.7031" y2="310.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="419" y="328.4111">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="200" x="423" y="327.3125">HealthState_VZD!=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="623" y="328.4111">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="608" y1="359.2109" y2="359.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="608" x2="608" y1="359.2109" y2="372.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="567" x2="608" y1="372.2109" y2="372.2109"/><polygon fill="#000000" points="577,368.2109,567,372.2109,577,376.2109,573,372.2109" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="573" y="353.4756">1</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="395" x="586" y="353.4756">HealthStateCheck einleiten(HealthStateCheck_VZD=0)</text><path d="M424,387.2109 L497,387.2109 L497,395.5625 L487,405.5625 L424,405.5625 L424,387.2109 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="529.6797" style="stroke:#000000;stroke-width:1.5;" width="910" x="424" y="387.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="439" y="401.7061">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="512" y="406.9189">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="316" x="516" y="405.8203">alle 5min UND HealthStateCheck_VZD&lt;=3</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="832" y="406.9189">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="876" x="451" y="435.6875"/><path d="M451,435.6875 L513,435.6875 L513,443.6875 L503,453.6875 L451,453.6875 L451,435.6875 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="464" y="451.1826">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="705" y="474.2969">Provider authentifizieren und Föderationsliste abrufen</text><path d="M434,519.1641 L495,519.1641 L495,527.5156 L485,537.5156 L434,537.5156 L434,519.1641 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="390.7266" style="stroke:#000000;stroke-width:1.5;" width="494" x="434" y="519.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="449" y="533.6592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="510" y="538.8721">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="196" x="514" y="537.7734">HealthState_VZD=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="710" y="538.8721">]</text><path d="M444,549.6406 L525,549.6406 L525,557.9922 L515,567.9922 L444,567.9922 L444,549.6406 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="66.7344" style="stroke:#000000;stroke-width:1.5;" width="419" x="444" y="549.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="459" y="564.1357">break</text><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="608" y1="595.375" y2="595.375"/><line style="stroke:#000000;stroke-width:1.0;" x1="608" x2="608" y1="595.375" y2="608.375"/><line style="stroke:#000000;stroke-width:1.0;" x1="567" x2="608" y1="608.375" y2="608.375"/><polygon fill="#000000" points="577,604.375,567,608.375,577,612.375,573,608.375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="573" y="589.6396">2</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="586" y="589.6396">HealthStateCheck_VZD abbrechen()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="434" x2="928" y1="624.375" y2="624.375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="439" y="642.083">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="200" x="443" y="640.9844">HealthState_VZD!=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="643" y="642.083">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="608" y1="694.2656" y2="694.2656"/><line style="stroke:#000000;stroke-width:1.0;" x1="608" x2="608" y1="694.2656" y2="707.2656"/><line style="stroke:#000000;stroke-width:1.0;" x1="567" x2="608" y1="707.2656" y2="707.2656"/><polygon fill="#000000" points="577,703.2656,567,707.2656,577,711.2656,573,707.2656" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="573" y="677.8389">3</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="235" x="586" y="667.1475">HealthStateCheck_VZD erhöhen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="586" y="688.5303">(HealthStateCheck_VZD+1)</text><path d="M444,722.2656 L505,722.2656 L505,730.6172 L495,740.6172 L444,740.6172 L444,722.2656 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="180.625" style="stroke:#000000;stroke-width:1.5;" width="474" x="444" y="722.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="459" y="736.7607">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="520" y="741.9736">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="196" x="524" y="740.875">HealthStateCheck_VZD=3</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="720" y="741.9736">]</text><polygon fill="#000000" points="780,769.125,790,773.125,780,777.125,784,773.125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="786" y1="773.125" y2="773.125"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="573" y="767.3896">4</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="189" x="586" y="767.3896">Incident-Event erzeugen()</text><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="613" y1="803.5078" y2="803.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="613" x2="613" y1="803.5078" y2="816.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="572" x2="613" y1="816.5078" y2="816.5078"/><polygon fill="#000000" points="582,812.5078,572,816.5078,582,820.5078,578,816.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="578" y="797.7725">5</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="591" y="797.7725">letzte vorhandene Föderationsliste puffern()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="571" x2="613" y1="861.8906" y2="861.8906"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="613" x2="613" y1="861.8906" y2="874.8906"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="566" x2="613" y1="874.8906" y2="874.8906"/><polygon fill="#000000" points="576,870.8906,566,874.8906,576,878.8906,572,874.8906" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="578" y="856.1553">6</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="591" y="856.1553">Föderationsliste</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1364" x="0" y="960.9531"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1364" y1="960.9531" y2="960.9531"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1364" y1="963.9531" y2="963.9531"/><rect fill="#EEEEEE" height="28.125" style="stroke:#000000;stroke-width:2.0;" width="100" x="632" y="947.8906"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="82" x="638" y="968.5">on request</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="720" y="969.1592"> </text><polygon fill="#000000" points="143,1030.7813,133,1034.7813,143,1038.7813,139,1034.7813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="137" x2="287" y1="1034.7813" y2="1034.7813"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="149" y="1018.3545">7</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="162" y="1007.6631">Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="103" x="162" y="1029.0459">aktualisieren()</text><polygon fill="#000000" points="544,1078.5977,554,1082.5977,544,1086.5977,548,1082.5977" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="132" x2="550" y1="1082.5977" y2="1082.5977"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="139" y="1076.8623">8</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="300" x="152" y="1076.8623">GET /I_internVerification(FLVersion_MP)</text><path d="M571,1047.7813 L571,1097.7813 L794,1097.7813 L794,1057.7813 L784,1047.7813 L571,1047.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M784,1047.7813 L784,1057.7813 L794,1057.7813 L784,1047.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="152" x="577" y="1069.3906">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="202" x="577" y="1089.5156">durch die gematik spezifiziert</text><path d="M444,1135.0313 L505,1135.0313 L505,1143.3828 L495,1153.3828 L444,1153.3828 L444,1135.0313 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="124.9531" style="stroke:#000000;stroke-width:1.5;" width="890" x="444" y="1135.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="459" y="1149.5264">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="520" y="1154.7393">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="444" x="524" y="1153.6406">HealthState_VZD=gesund UND Alter_Föderationsliste&gt;=1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="972" y="1154.7393">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="876" x="451" y="1183.5078"/><path d="M451,1183.5078 L513,1183.5078 L513,1191.5078 L503,1201.5078 L451,1201.5078 L451,1183.5078 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="464" y="1199.0029">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="705" y="1222.1172">Provider authentifizieren und Föderationsliste abrufen</text><path d="M10,1273.9844 L91,1273.9844 L91,1282.3359 L81,1292.3359 L10,1292.3359 L10,1273.9844 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="216.0078" style="stroke:#000000;stroke-width:1.5;" width="788" x="10" y="1273.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="25" y="1288.4795">break</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="106" y="1293.6924">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="338" x="110" y="1292.5938">Alter_Föderationsliste&gt;TTL_Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="448" y="1293.6924">]</text><polygon fill="#000000" points="143,1320.8438,133,1324.8438,143,1328.8438,139,1324.8438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="137" x2="555" y1="1324.8438" y2="1324.8438"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="9" x="379" y="1319.1084">9</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="157" x="392" y="1319.1084">FLStatus_RD=veraltet</text><polygon fill="#000000" points="789,1356.2266,799,1360.2266,789,1364.2266,793,1360.2266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="795" y1="1360.2266" y2="1360.2266"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="573" y="1354.4912">10</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="189" x="595" y="1354.4912">Incident-Event erzeugen()</text><line style="stroke:#000000;stroke-width:1.0;" x1="132" x2="174" y1="1395.6094" y2="1395.6094"/><line style="stroke:#000000;stroke-width:1.0;" x1="174" x2="174" y1="1395.6094" y2="1408.6094"/><line style="stroke:#000000;stroke-width:1.0;" x1="133" x2="174" y1="1408.6094" y2="1408.6094"/><polygon fill="#000000" points="143,1404.6094,133,1408.6094,143,1412.6094,139,1408.6094" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="139" y="1389.874">11</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="388" x="161" y="1389.874">unterbinde Registrierungsdienst-Requests(Dauer=1h)</text><line style="stroke:#000000;stroke-width:1.0;" x1="132" x2="174" y1="1443.9922" y2="1443.9922"/><line style="stroke:#000000;stroke-width:1.0;" x1="174" x2="174" y1="1443.9922" y2="1456.9922"/><line style="stroke:#000000;stroke-width:1.0;" x1="133" x2="174" y1="1456.9922" y2="1456.9922"/><polygon fill="#000000" points="143,1452.9922,133,1456.9922,143,1460.9922,139,1456.9922" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="139" y="1438.2568">12</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="382" x="161" y="1438.2568">blockiere Kommunikation zu anderen Homeservern()</text><line style="stroke:#000000;stroke-width:1.0;" x1="566" x2="613" y1="1540.7578" y2="1540.7578"/><line style="stroke:#000000;stroke-width:1.0;" x1="613" x2="613" y1="1540.7578" y2="1553.7578"/><line style="stroke:#000000;stroke-width:1.0;" x1="572" x2="613" y1="1553.7578" y2="1553.7578"/><polygon fill="#000000" points="582,1549.7578,572,1553.7578,582,1557.7578,578,1553.7578" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="578" y="1524.3311">13</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="153" x="600" y="1513.6396">vergleiche Versionen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="237" x="600" y="1535.0225">(FLVersion_MP, FLVersion_RD)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="571" x2="613" y1="1599.1406" y2="1599.1406"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="613" x2="613" y1="1599.1406" y2="1612.1406"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="566" x2="613" y1="1612.1406" y2="1612.1406"/><polygon fill="#000000" points="576,1608.1406,566,1612.1406,576,1616.1406,572,1612.1406" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="578" y="1593.4053">14</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="172" x="600" y="1593.4053">Vergleichsergebnis_RD</text><path d="M10,1622.1406 L71,1622.1406 L71,1630.4922 L61,1640.4922 L10,1640.4922 L10,1622.1406 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="242.8438" style="stroke:#000000;stroke-width:1.5;" width="668" x="10" y="1622.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="1636.6357">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="86" y="1641.8486">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="260" x="90" y="1640.75">Vergleichsergebnis_RD=identisch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="350" y="1641.8486">]</text><polygon fill="#000000" points="143,1694,133,1698,143,1702,139,1698" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="137" x2="555" y1="1698" y2="1698"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="375" y="1692.2646">15</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="152" x="397" y="1692.2646">FLStatus_MP=aktuell</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="678" y1="1732" y2="1732"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="15" y="1749.708">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="264" x="19" y="1748.6094">Vergleichsergebnis_RD!=identisch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="283" y="1749.708">]</text><polygon fill="#000000" points="143,1776.5078,133,1780.5078,143,1784.5078,139,1780.5078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="137" x2="555" y1="1780.5078" y2="1780.5078"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="18" x="274" y="1774.7725">16</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="253" x="296" y="1774.7725">Föderationsliste, x5c-Zertifikatsliste</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="256" x="17" y="1788.5078"/><path d="M17,1788.5078 L79,1788.5078 L79,1796.5078 L69,1806.5078 L17,1806.5078 L17,1788.5078 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="30" y="1804.0029">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="248" x="21" y="1827.1172">Signatur der Föderationsliste prüfen</text><!--MD5=[21d53828a76d3418e40f2447ce2efde0]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
'ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
'ActorFontName Aapex
}

autonumber

box <size:18>Messenger-Service\n #WhiteSmoke
participant MP as "Messenger-Proxy"
end box
participant RD as "Registrierungs-Dienst"
box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
  participant FP as "FHIR-Proxy"
  participant AS as "OAuth-Service"
end box

== <size:16>scheduled</size> ==

loop#LightGrey <size:16>alle 1h</size>
  alt#LightGrey <size:16>HealthState_VZD=gesund ODER Alter_Föderationsliste>=1h</size>
  activate RD
  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

  else <size:16>HealthState_VZD!=gesund</size>
    RD->RD: HealthStateCheck einleiten(HealthStateCheck_VZD=0)
    loop#LightGrey <size:16>alle 5min UND HealthStateCheck_VZD<=3</size>
      |||
      ref over AS, FP, RD
        <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
      end ref
      |||
      alt#LightGrey <size:16>HealthState_VZD=gesund</size>
        break#LightGrey #LightPink
          RD->RD: HealthStateCheck_VZD abbrechen()
        end
      else <size:16>HealthState_VZD!=gesund</size>
        RD->RD: HealthStateCheck_VZD erhöhen\n(HealthStateCheck_VZD+1)
        alt#LightGrey <size:16>HealthStateCheck_VZD=3</size>
          RD ->?: Incident-Event erzeugen()
          RD->RD++: letzte vorhandene Föderationsliste puffern()
          return Föderationsliste
        |||
        end
      end
    end
    deactivate RD
  end
end

== <size:16>on request</size> ==

MP <-?: Föderationsliste \naktualisieren()
activate MP
MP->RD: GET /I_internVerification(FLVersion_MP)
note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
|||
  Activate RD

alt#LightGrey <size:16>HealthState_VZD=gesund UND Alter_Föderationsliste>=1h </size>

  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

end

break#LightGrey #LightPink <size:16>Alter_Föderationsliste>TTL_Föderationsliste</size>
  RD- ->MP: FLStatus_RD=veraltet
  RD ->?: Incident-Event erzeugen()
  MP->MP: unterbinde Registrierungsdienst-Requests(Dauer=1h)
  MP->MP: blockiere Kommunikation zu anderen Homeservern()
  |||
end

  RD->RD++: vergleiche Versionen\n(FLVersion_MP, FLVersion_RD)
  return Vergleichsergebnis_RD

  alt#LightGrey <size:16>Vergleichsergebnis_RD=identisch</size>
    |||
    RD- ->MP: FLStatus_MP=aktuell
    |||

  else <size:16>Vergleichsergebnis_RD!=identisch</size>
    RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
    ref over MP
      <size:16>Signatur der Föderationsliste prüfen</size>
    end ref
    |||
  end
  |||
  Deactivate RD
  MP-[hidden]> MP
  deactivate MP
@enduml

@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
}

autonumber

box <size:18>Messenger-Service\n #WhiteSmoke
participant MP as "Messenger-Proxy"
end box
participant RD as "Registrierungs-Dienst"
box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
  participant FP as "FHIR-Proxy"
  participant AS as "OAuth-Service"
end box

== <size:16>scheduled</size> ==

loop#LightGrey <size:16>alle 1h</size>
  alt#LightGrey <size:16>HealthState_VZD=gesund ODER Alter_Föderationsliste>=1h</size>
  activate RD
  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

  else <size:16>HealthState_VZD!=gesund</size>
    RD->RD: HealthStateCheck einleiten(HealthStateCheck_VZD=0)
    loop#LightGrey <size:16>alle 5min UND HealthStateCheck_VZD<=3</size>
      |||
      ref over AS, FP, RD
        <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
      end ref
      |||
      alt#LightGrey <size:16>HealthState_VZD=gesund</size>
        break#LightGrey #LightPink
          RD->RD: HealthStateCheck_VZD abbrechen()
        end
      else <size:16>HealthState_VZD!=gesund</size>
        RD->RD: HealthStateCheck_VZD erhöhen\n(HealthStateCheck_VZD+1)
        alt#LightGrey <size:16>HealthStateCheck_VZD=3</size>
          RD ->?: Incident-Event erzeugen()
          RD->RD++: letzte vorhandene Föderationsliste puffern()
          return Föderationsliste
        |||
        end
      end
    end
    deactivate RD
  end
end

== <size:16>on request</size> ==

MP <-?: Föderationsliste \naktualisieren()
activate MP
MP->RD: GET /I_internVerification(FLVersion_MP)
note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
|||
  Activate RD

alt#LightGrey <size:16>HealthState_VZD=gesund UND Alter_Föderationsliste>=1h </size>

  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

end

break#LightGrey #LightPink <size:16>Alter_Föderationsliste>TTL_Föderationsliste</size>
  RD- ->MP: FLStatus_RD=veraltet
  RD ->?: Incident-Event erzeugen()
  MP->MP: unterbinde Registrierungsdienst-Requests(Dauer=1h)
  MP->MP: blockiere Kommunikation zu anderen Homeservern()
  |||
end

  RD->RD++: vergleiche Versionen\n(FLVersion_MP, FLVersion_RD)
  return Vergleichsergebnis_RD

  alt#LightGrey <size:16>Vergleichsergebnis_RD=identisch</size>
    |||
    RD- ->MP: FLStatus_MP=aktuell
    |||

  else <size:16>Vergleichsergebnis_RD!=identisch</size>
    RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
    ref over MP
      <size:16>Signatur der Föderationsliste prüfen</size>
    end ref
    |||
  end
  |||
  Deactivate RD
  MP-[hidden]> MP
  deactivate MP
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>