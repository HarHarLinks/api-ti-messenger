ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

:imagesdir: ../../images
:toc: macro
:toclevels: 5
:toc-title: Inhaltsverzeichnis
:numbered:

image:gematik_logo.svg[width=70%]

toc::[]

= TI-Messenger v1.1 changes
== Zusammenfassung
Die folgende Seite listet notwendige Änderungsvorschläge (CR) auf, die noch im Rahmen des TI-Messenger-Dienstes in der Version 1.1 gültig werden sollen. Bei den hier genannten Änderungen handelt es sich um Erkenntnisse aus der Entwicklung der Referenzimplementierung des TI-Messengers sowie aus den Vorschlägen der Industriegesprächen. Ziel ist es, alle Änderungsvorschläge transparent und allen interessierten Herstellern zur gemeinsamen Abstimmung zur Verfügung zu stellen.

CAUTION: Die hier genannten Änderungen sind als Abstimmungsgrundlage zu verstehen.


== Änderungsvorschläge
Im Folgenden werden alle Änderungsvorschläge der gematik beschrieben, die für den TI-Messenger Dienst in der Version 1.1 erforderlich sind.

=== CR_001 - Korrektur der Parameter am FHIR-Directory /tim-authenticate Endpoint
IMPORTANT: Die vorgesehenen Änderungen für den CR_001 werden zurückgestellt und für eine zukünftige Version des FHIR-Directory vorgesehen. Für die Zulassung des TI-Messengers ist der */tim-authenticate* Endpoint wie folgt zu bedienen, um ein Search-Access-Token ausgestellt zu bekommen.

*Beispiel*
[source,]
----
GET https://fhir-directory-test.vzd.ti-dienste.de/tim-authenticate?mxId=matrix.dev.service-ti.de

HEADER
{
  X-Matrix-OpenID-Token:(Vom Homeserver ausgestelltes Matrix-Openid-Token)
}
----
Ein ausführlicher Ablauf zum Token-Austauch ist in der API Dokumentation zum FHIR-Directory beschrieben: https://github.com/gematik/api-vzd/blob/feature/ILF-FHIR_VZD/docs/gemILF_FHIR_VZD.adoc#211-authentication

=== CR_002 - Verhinderung der unauthorisierten Bestellung eines Messenger-Services
Es ist technisch abgesichert, dass ein Messenger-Service nur bestellt werden kann, wenn der Besitz einer SMC-B nachgewiesen wurde. In einer Organisation des Gesundheitswesens kann es jedoch sein, dass Mitarbeiter unauthorisiert einen Messenger-Service bestellen. Es fehlt eine ergänzende Regelung, die eine unauthorisierte Bestellung eines Messenger-Service verhindert.

*Lösungsidee:* Ein Messenger-Service kann, wie bisher spezifiziert, von einer Organisation des Gesundheitswesens bestellt werden. Der Vertrag über den bestellten Messenger-Service wird per Post an eine verifizierte Adresse der Organisation (z. B. durch Abfrage des FHIR-Directories ermittelte Anschrift der Organisation) gesendet. Erst nach Eingang des unterzeichneten Vertrages beim TI-Messenger-Anbieter wird der Messenger-Service aktiviert.

=== CR_003 - Signatur und Gültigkeit der Föderationsliste
In der aktuellen Spezifikation ist eine Signatur der Föderationsliste festgelegt. Die Signatur war bisher noch nicht in der OpenAPI Definition der Schnittstelle `I_VZD_TIM_Provider_Services` berücksichtigt. Dies wurde in der https://raw.githubusercontent.com/gematik/api-vzd/develop/src/openapi/I_VZD_TIM_Provider_Services.yaml[I_VZD_TIM_Provider_Services] in der Version 1.2.0 angepasst. Durch diese Änderung wurde es erforderlich die Struktur der Föderationsliste in einem JSON Schema festzulegen, da die Struktur nicht mehr in der OpenAPI Definition sichtbar ist (siehe hierzu bitte: https://github.com/gematik/api-vzd/blob/develop/src/schema/FederationList.json[JSON-Schema der Föderationsliste]. Darüber hinaus hat sich der Prozess zum Abruf der Föderationsliste geändert. Der link:../use-cases/MS-update-federation-list.adoc[Use Case zur Aktualisierung der Föderationsliste] wurde entsprechend angepasst. Ebenfalls hat die Föderationsliste keinen Gültigkeitszeitraum mehr. Die Prüfung wurde beim Messenger-Proxy entfernt.

=== CR_004 - Nachweis des Besitzes einer SMC-B beim Bestellprozess eines Messenger-Services

Es wird vorgeschlagen, dass anstatt einer OIDC-Authentifizierung zum Nachweis des Besitzes einer SMC-B auch ein KIM-basiertes Verfahren genutzt werden kann.

*Möglicher Ablauf:* +
Im Bestellvorgang wird der Akteur (Org-Admin) darauf hingewiesen, dass ein Messenger-Service nur von einer verifizierten Organisation des Gesundheitswesens bestellt werden kann und daher eine Authentifizierung notwendig ist. Der Org-Admin wird aufgefordert seine KIM Mail-Adresse in eine Eingabemaske einzutragen. Der Registrierungs-Dienst fragt im VZD die `telematikID` sowie die `professionOID` zur angegebenen KIM-Adresse ab und prüft die `professionOID` (muss zu einer Organisation des Gesundheitswesens gehören). Der Registrierungs-Dienst sendet dem Akteur eine KIM-Nachricht mit einer URL an die angegebene KIM-Adresse und fordert den Org-Admin auf, die KIM-Nachricht zu öffnen und die darin befindliche URL zu öffnen. Durch das Öffnen des Links wird der Akteur wieder in den Bestellprozess zurückgeführt und die Authentisierung ist abgeschlossen (weil durch das Öffnen der KIM-Nachricht nachgewiesen ist, dass die E-Mail erfolgreich entschlüsselt werden konnte, was nur mit dem privaten Schlüssel der SMC-B möglich ist).

*Rahmenbedingungen:* +
TI-Messenger Anbieter benötigen für das oben vorgestellte Verfahren eine SMC-B Org sowie einen Konnektor und ein eHealth Kartenterminal. Die gematik wird die Voraussetzungen schaffen, dass TI-Messenger Anbieter auch eine SMC-B Org erhalten können.

=== CR_005 - Authentisierung am FHIR-Directory /owner-authenticate Endpoint
Bei der Authentisierung von Organisationen vertreten durch den Org-Admin am */owner-authenticate* Endpoint ist bisher folgernder Ablauf vorgesehen:

- Der Org-Admin-Client führt nach dem *login* des Org-Admins am TI-Messenger Registrierungsdienst ein */request_token* aus. Als Ergebnis erhält der Org-Admin-Client ein id_token.
- Mit dem id_token im Authentication Header ruft der Org-Admin-Client den */owner-authenticate* Endpoint am FHIR-Directory auf.
- Nach Prüfung des id_token durch das FHIR-Directory wird der Org-Admin-Client zum Authorization Endpoint des IDP umgeleitet und damit eine OIDC Authentisierung eingeleitet.

*Optimierung* +
Da ein Org-Admin-Account am Registrierungs-Dienst nur angelegt werden kann, wenn eine erfolgreiche Authentisierung einer Organisation mit Hilfe einer SMC-B durchgeführt wurde, ist eine erneute SMC-B Authentifizierung am FHIR-Directory nicht mehr erforderlich. Dies trifft zu, wenn das FHIR-Directory den Registrierungs-Diensten aller TI-Messenger-Anbieter vertraut und wenn die erforderlichen Daten (`telematikID` und `professionOID`) im *id_token* des Registrierungs-Denstes enthalten sind.

Das Vertrauen zu den Registrierungsdiensten der TI-Messenger Anbieter wird hergestellt, wenn die TI-Messenger Anbieter Credentials beim FHIR-Directory für die Schnittstelle I_VZD_TIM_Provider_Services beantragen. Dabei übergibt der TI-Messenger Anbieter den hash des Signatur-Zertifikats, das für die Signatur des id_tokens verwendet wird, an das FHIR-Directory.

Das vom Registrierungsdienst ausgestellte id_token wird durch das FHIR-Directory geprüft (Algorithmus, Signatur, Signaturzertifikat (Zertifikatstyp, technische Rolle, hash des Zertifikats, OCSP)). Die genauen Prüfschritte sind der Spezifikation zum VZD-FHIR-Directory zu entnehmen. Das zur Signatur des id_token verwendete Zertifikat muss aus der Komponenten-PKI der TI stammen (Zertifikatstyp C.FD.SIG, technische Rolle oid_tim) und im JWT HEADER hinterlegt werden. Das Zertifikat kann vom TI-Messenger Anbieter über einen Service der TI-Komponenten-PKI erzeugt werden. 

.Vereinfachter Ablauf zur Änderung der Organisations Einträge im FHIR-Directory
image::diagrams/TI-Messenger-Dienst/Ressourcen/UC_10059_Seq.svg[FHIR-Directory owner organization]

Im Sequenzdiagramm ist dargestellt, dass für die Authentisierung des Org-Admin am Auth-Service nur noch das *id_token* vom Registrierungs-Dienst benötigt wird.

Für Nutzer eines HBAs ändert sich nichts. Das heißt der `/owner-authenticate` Endpoint des Auth-Service unterstützt den OIDC Authorization Code Flow. Daher ist es möglich am Registrierungs-Dienst auch den Authentication Endpoint und den Token Endpoint eines IDP zu implementieren, um für Org-Admins den OIDC Authorization Code Flow verwenden zu können.

*Aufbau des id_tokens*
[source, ruby]
----
HEADER
{
  "alg": "ES256",
  "typ": "JWT"
  "x5c": [
     "<X.509 Sig-Cert, base64-encoded DER>",
     "<X.509 CA-Cert, base64-encoded DER>"
}
PAYLOAD
{
  "sub": "1234567890",
  "iss": "<url des Registrierungs-Dienst-Endpunkts, über den das Token ausgestellt wurde>",
  "aud": "https://vzd-fhir-directory.vzd.ti-dienste.de/owner-authenticate",
  "professionOID": "<professionOID der Organisation>",
  "idNummer": "<telematikID der Organisation>",
  "iat": "1516239022",
  "exp": "1516239022"
}
----

Die telematikID ist im Attribut "idNummer" angegeben.

=== CR_006 - Prüfung auf Föderationszugehörigkeit

In der aktuellen Spezifikation (TI-Messenger v1.1.0) ist die Prüfung auf Föderation unzureichend, da zum Beispiel nach der erfolgreichen Einladung einer Person in einem gemeinsamen Chatraum anschließend die beteiligten Matrix-Homeserver nicht mehr auf Föderationszugehörigkeit geprüft werden.

*Lösungsidee:* Die Prüfung auf Domainzugehörigkeit muss bei der Client-Server API bei jedem `Invite` und `createRoom` Event erfolgen. Bei einem `cresteRoom`-Event können zum Beispiel Invites integriert worden sein. Ebenfalls muss bei der Server-Server API die Föderationsprüfung bei jedem Matrix-Event erfolgen, damit nicht mehr zur Föderation gehörende Matrix-Homeserver weiter kontaktiert werden können. Hierfür ist vorgesehen, dass am Messenger-Proxy im Authorization-Header die "origin" bei eingehender und "destination" bei ausgehender Föderation geprüft werden. Siehe auch https://spec.matrix.org/latest/server-server-api/#authentication[Matrix Specification
Server-Server API Authentication]. Der Messenger-Proxy muss entsprechend angepasst werden.

=== CR_007 - Änderung der Prüfverfahren

Im Produkttypsteckbrief des TI-Messenger-Clients sind viele Anforderungen dem Prüfverfahren Produktgutachten zugeordnet. Ein Produktgutachten ist jedoch sehr aufwändig und damit teuer. Die Anforderungen wurden durch die gematik neu bewertet und in den meisten Fällen einem anderen Prüfverfahren zugeordnet. Dadurch ist es gelungen, dass kein Produktgutachten durch die TI-Messenger Hersteller in Auftrag gegeben werden muss.

Die Änderungen an den Anforderungen sind hier zusammengefasst.

.*Neuzuordnung des Prüfverfahren*
[cols="1,1,1,4"]
|===
|*Anforderung*|*Dokument*|*bisheriges Prüfverfahren*|*Änderung*

|A_17124 TLS-Verbindungen (ECC-Migration)
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Herstellererklärung*. Es muss durch den Hersteller dokumentiert werden, wie und wo die Umsetzung erfolgt ist.

|A_18464 TLS-Verbindungen, nicht Version 1.1
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|A_18467 TLS-Verbindungen, Version 1.3
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|A_21275-01 TLS-Verbindungen, zulässige Hashfunktionen bei Signaturen im TLS-Handshake
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_4359 X.509-Identitäten für die Durchführung einer TLS-Authentifizierung
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_4367 Zufallszahlengenerator
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_4368 Schlüsselerzeugung
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_4387 TLS-Verbindungen, nicht Version 1.0
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_5035 Nichtverwendung des SSL-Protokolls
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_5322 Weitere Vorgaben für TLS-Verbindungen
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|GS-A_4384-01 TLS-Verbindungen
|gemSpec_Krypt
|Produktgutachten
|Ersetzt die alte Version von GS-A_4384. Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|GS-A_4385 TLS-Verbindungen, Version 1.2
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Herstellererklärung*. Es muss durch den Hersteller dokumentiert werden, wie und wo die Umsetzung erfolgt ist.

|GS-A_5339 TLS-Verbindungen, erweiterte Webbrowser-Interoperabilität
|gemSpec_Krypt
|Produktgutachten
|Die Anforderung *entfällt*.

|GS-A_5526 TLS-Renegotiation-Indication-Extension
|gemSpec_Krypt
|Produktgutachten
|Das Prüfverfahren wird geändert in *Herstellererklärung*. Es muss durch den Hersteller dokumentiert werden, wie und wo die Umsetzung erfolgt ist.

|A_22718 Mandantenfähigkeit von TI-Messenger-Clients
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|A_22723 Versand von Dateien mittels Matrix
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Herstellererklärung*. Es muss durch den Hersteller dokumentiert werden, wie und wo die Umsetzung erfolgt ist.

|A_22724 Abschottung der Inhalte im TI-Messenger-Client
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|A_22793 Ende-zu-Ende Verschlüsselung
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Es muss durch den Sicherheitsgutachter geprüft werden, wie und wo die Umsetzung erfolgt ist.

|A_22795 Einbringung und Speicherung von Schlüsseln und Token
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22798 Privacy by Default
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Die Anforderung *entfällt*.

|A_22799 Verwendung von OWASP Mobile
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*. Inhaltlich wird die Anforderung geprüft, da einige Zuordnungen zu BSI-Vorgaben nicht korrekt zu sein scheinen.

|A_22800 Sicherheitsrisiken von Software Bibliotheken minimieren
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Herstellererklärung*. Es muss durch den Hersteller dokumentiert werden, wie und wo die Umsetzung erfolgt ist.

|A_22937 Einsatz nur von auditierter Verschlüsselung
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22955 Anforderungen-Gutachten aus der Konferenz der unabhängigen Datenschutzaufsichtsbehörden
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22964 Zugriffsschutz auf Administrationsfunktionen
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_23114 App-Sperre TI-Messenger-Client
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_23130 Nutzung von Daten durch Drittsysteme
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_23115 Prüfung Device Integrität
|gemSpec_TI-Messenger-Client
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22809 Flächendeckende Verwendung von TLS für Hersteller
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22818 Sicherheitsrisiken von Software-Bibliotheken minimieren
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22816 Device Verification, Cross-Signing und SSSS für TI-Messenger-Fachdienste
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22812 Interoperabilität von Zusatzfunktionen für den TI-Messenger-Fachdienst
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22808 Push-Benachrichtigungen Messenger-Service
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22811 Löschfristen für Matrix-Homeserver
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.

|A_22810 Abweichungen vom Matrix-Standard
|gemSpec_TI-Messenger-FD
|Produktgutachten
|Das Prüfverfahren wird geändert in *Sicherheitsgutachten*.
|===

=== CR_008 - User-Agent für TI-M Clients
Der TI-Messenger Client soll bestimmte Kennungsparameter an den TI-Messenger Fachdienst im HTTP-Header übermitteln. Die Übermittlung wird mit der folgenden Änderung an gängige Standards angepasst.

*A_23104-01 - TI-M Client User-Agent*

Der TI-Messenger-Client und der TI-Messenger-Client mit Administrationsfunktionen (Org-Admin-Client) MUSS folgende User-Agent-Kennung bei jedem Verbindungsaufbau zum TI-Messenger-Fachdienst übermitteln:  User-Agent: $Produkttypversion,$Produktversion,$Auspraegung,$Plattform,$OS,$OS-Version,$client_id  Zur Beschreibung der jeweiligen Datenfelder, siehe [gemSpec_Perf#A_22940]. <=

=== CR_009 - Spezifikationsoptimierungen
Der TI-Messenger Client soll bestimmte Kennungsparameter an den TI-Messenger Fachdienst im HTTP-Header übermitteln. Die Übermittlung wird mit der folgenden Änderung an gängige Standards angepasst.

.*Spezifikationsoptimierungen*
[cols="1,1,1,3"]
|===
|*interne laufende Nummer*|*Dokument*|*Alt*|*Neu*
|1
|Dienst
|In Abbildung 20 wird bei einigen Aufrufen nach Erhalt des search-accesstoken die MXID des Users verwendet. Diese wird für die Authentisierung nicht benötigt und die Rückgabe an den Client wird ein FHIR Bundle sein.
|https://github.com/gematik/api-ti-messenger/blob/feature/C_11306/images/diagrams/TI-Messenger-Dienst/Ressourcen/UC_Directory_search_Seq.png
|3
|Client
|In der Client Spezifikation war beschrieben, dass TI-Messenger Clients die MXID verstecken MÜSSEN.
|Das verstecken müssen wurde entfernt und explizit erlaubt Matrix konform die MXID zu verwenden, um bei gleichem Displaynamen einen User eindeutig identifizieren zu können.
|5
|Client und Fachdienst
|Bisher haben die Spezifikationen von Client und Fachdienst Anforderungen enthalten, die eine CC-Evaluierung als Ersatz für das Produktgutachten ermöglichten. Ohne Notwendigkeit für ein Produktgutachten sind diese Anforderungen jedoch ncht zweckmäßig.
|Die Anforderungen sind entfallen.
|6
|Dienst
|In Kapitel 5.6 "Pro HealthcareService darf nur eine Endpoint-Ressource für den payloadType "TI-Messenger chat" existieren.
|Diese Einschränkung wird gestrichen.
|8
|Client und Fachdienst
|Es gab bisher keine Anforderungen zur Komplexität von Passwörtern und Mechanismen zur Verhinderung von deren Wiederverwendung.
|Client und Fachdienst wurden um Anforderungen ergänzt (A_23611, A_23612), die Vorgaben zur Wahl von Passwortrichtlinien machen, sowie zur Implementierung von Mechanismen im Client, die eine Wiederverwendung von Passwörtern an den Stellen verhindern, wo sie dem Homeserver das Brechen der E2EE ermöglichen würden.
|9
|Client
|A_22802 fordert unter anderem die Ausgabe einer Prüfsumme zur Verifikation der Integrität einer installierten Version des TI-Messenger-Clients. Dies ist jedoch nicht zweckmäßig.
|A_22802 wird abgelöst durch eine andere AFO, welche die Ausgabe jener Prüfsumme nicht mehr fordert.
|10
|Client und Fachdienst
|AFO A_22955 hat bisher zwei Anforderungen formuliert, die beide schwer verständlich waren. Weiterhin war eine davon (Verschlüsselung) in der angegeben Form nicht sinnvoll erfüllbar, während die andere (Zwangsbeendigung von Sitzungen) durch den Fachdienst zu iplementieren ist.
|Diese AFO wurde aufgeteilt in eine AFO für den Client, welche die Maßnahmen zum Schutz der gespeicherten Daten spezifiziert, sowie eine weitere AFO für den Fachdienst, welche die Zwangsterminierung von aktiven Sitzungen behandelt.
|11
|Client
|Bisher hat die Spezifikation des Clients die Generierung datenschutzfreundlicher MXIDs (A_22719) gefordert und ein entsprechendes Anzeptanzkriterium (ML-124045) formuliert. Die Anzeige der MXID wurde per normativem Fließtext untersagt.
|Die Anforderung und das Akzeptanzkriterium sind entfallen und der normative Fließtext schreibt nun sogar die Anzeige der MXID vor, wenn sich Akteure mit identischen Displaynamen in einem Raum befinden.
|12
|Dienst
|Bisher erfolgte die Zulassung auf Basis von Nachweisen und Tests in TU/RU.
|Zulassung bedarf nun der Teilnahme an einer kontrollierten Inbetriebnahme und der Erbringung von Nachweisen in der Produktivumgebung, um Interoparbilitätsproblemen vorzubeugen.
|14
|Client
|Bedeutung der Mandantenfähigkeit und des Zugriffschutzes für Administrationsfunktionen hat sich in bisherigen Gesprächen als unklar erwiesen, im besonderen die der "separaten User-Interfaces". Anforderungen wurden unterschiedlich interpretiert.
|Ergänzung der bestehenden Anforderungen zur Mandantenfähigkeit und zum Zugriffsschutz für Administrationsfunktionen für die Verbesserung des Verständnisses. 
|15
|Client und Fachdienst
|Spezifikation hat bisher in allen Fällen Ende-zu-Ende-Verschlüsselung (E2EE) gefordert, die bei öffentlichen Räumen aber nicht immer notwendig ist und bei hohen Teilnehmerzahlen (in Räumen) zu starken Performance-Einbußen führen kann.
|Die Erlaubnis des Verzichts auf E2EE bei öffentlichen Räumen ist nun per Anforderung und normativem Fließtext geregelt.
|16
|Client
|Anforderung zur Umsetzung von Löschfristen am Client hat bisher eine technisch kaum/nicht realisierbare Verfahrensweise gefordert.
|Anforderung wurde umgeschrieben, um das reine Löschverhalten zu spezifizieren. Weiterhin wurde eine zusätzliche Anforderung eingebracht, die eine fristbasierte Benachrichtigung der Nutzer zur Datenbereinigung vorschreibt, sodass diese fallbasiert über die Löschung entscheiden können. Dies dient vor allem der Vermeidung logischer Fehler und schlechter Nutzererfahrung. Sollten Räume lokal gelöscht werden, denen jeweilige Nutzer noch angehören, würden diese jegliche Möglichkeit zur Wiederaufnahme der Kommunikation verlieren, weil die lokale Datenbasis entfernt wurde, während RÄume und Inhalte server-seitig noch existieren.
|18
|Client
|Anforderung zur Berücksichtigung der OWASP Mobile Top 10 beinhaltet fehlerhafte Referenzenz auf Prüfvorschrift für den Produktgutachter des "ePA-Frontend des Versicherten" und des "E-Rezept-Frontend des Versicherten".
|Der Verweis auf die genannten Prüfvorschrift wurde entfernt, weil die Umsetzung geeigneter Maßnahmen zur Abwehr der OWASP Mobile Top 10 Risiken dem Hersteller obliegt. Der Nachweis über Wahl und Umsetzung geeigneter Maßnahmen ist im Rahmen des geforderten Sicherheitsgutachtens zu erbringen und bedarf keiner dedizierten Prüfvorschrift.
|19
|Client
|Im Anwendungsfall 6.5 Akteuer(User-HBA) im Verzeichnisdienst hinzufügen wird bei der Übergabe des Auth Code an das VZD-FHIR-Directory der Endpunkt /owner-authenticate verwendet.
|Das VZD-FHIR-Directory bietet die Übergabe des Auth Code über den Endpunkt /signin-gematik-idp-dienst an. Das Sequentzdiagramm zum Anwendungsfall wurde entsprechend angepasst. https://github.com/gematik/api-ti-messenger/blob/feature/C_11306/docs/use-cases/VZD-AF10058-add-practitioner.adoc 
|===
